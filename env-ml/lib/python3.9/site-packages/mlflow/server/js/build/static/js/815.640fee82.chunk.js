"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[815],{15094:function(e,t,r){r.r(t),r.d(t,{ExperimentPage:function(){return Qi},default:function(){return Ji}});var n=r(32),a=r(52660),i=r(30955),s=r(32597),o=r(13320),l=r(77295),c=r(53512);const d=c.I0;var u=r(95083);const p=(0,n.createContext)(null),h=e=>{let{children:t,actions:r}=e;const[a,i]=(0,n.useState)([]),[c,h]=(0,n.useState)(!1),[m,g]=(0,n.useState)(null),v=d(),f=(0,n.useCallback)((e=>{g(null),(()=>{const t=e.map((e=>{const t=r.getExperimentApi(e);return v(t).catch((e=>{s.Z.logErrorAndNotifyUser(e)})),t.meta.id}));i((e=>(0,o.isEqual)(t,e)?e:t))})()}),[r,v]),y=(0,n.useMemo)((()=>({fetchExperiments:f,isLoadingExperiment:c,requestError:m,actions:r})),[r,f,c,m]);return(0,u.tZ)(p.Provider,{value:y,children:(0,u.tZ)(l.ZP,{shouldOptimisticallyRender:!0,requestIds:a,children:(e,r,n)=>(h(n.some((e=>a.includes(e.id)&&e.active))),m||n.forEach((e=>{e.error&&g(e.error)})),t)})})};var m=r(10993),g=r(29546),v=r(7017),f=r(52335);var y=r.p+"static/media/permission-denied-lock.16036747d57cd663d7df223781a447b2.svg",x=r(22240);function C(e){let{errorMessage:t}=e;const{theme:r}=(0,x.u)();return(0,u.BX)("div",{className:"center",children:[(0,u.tZ)("img",{style:{height:300,marginTop:80},src:y,alt:"permission denied"}),(0,u.tZ)("h1",{style:{paddingTop:10},children:"Permission Denied"}),(0,u.tZ)("h2",{"data-testid":"error-message",css:(0,f.iv)({color:r.colors.textSecondary},""),children:t||"The current user does not have permission to view this page."})]})}var b=r(5206);const Z=e=>{let{artifactLocation:t}=e;return(0,u.tZ)(u.HY,{children:t})},E=n.memo((e=>{let{experiment:t}=e;return(0,u.BX)("div",{css:R.container,children:[(0,u.BX)(m.ZT$.Text,{color:"secondary",children:[(0,u.tZ)(b.Z,{id:"PZGZHV",defaultMessage:"Experiment ID"}),": ",t.experiment_id]}),(0,u.BX)(m.ZT$.Text,{color:"secondary",children:[(0,u.tZ)(b.Z,{id:"8/7V3S",defaultMessage:"Artifact Location"}),": ",(0,u.tZ)(Z,{artifactLocation:t.artifact_location})]})]})})),R={container:e=>({display:"flex",gap:e.spacing.lg})};var S=r(70235),k=r(82067),w=r(78429),M=r(33082);const T=()=>{const e=(0,n.useContext)(p);if(!e)throw new Error("Trying to use GetExperimentsContext actions outside of the context!");return e},B=n.memo((e=>{let{experiment:t}=e;const r=(0,c.v9)((e=>{const r=(0,w.aq)(t.experiment_id,e);return r?(e=>{var t;return(null===(t=Object.values(e).find((e=>e.getKey()===M._)))||void 0===t?void 0:t.value)||void 0})(r):""})),[a,i]=(0,n.useState)(!1),{actions:{setExperimentTagApi:s}}=T(),o=d(),l=(0,n.useCallback)((e=>{const r=s(t.experiment_id,M._,e);o(r).then((()=>i(!1)))}),[t.experiment_id,s,o]);return(0,u.tZ)(S.a,{title:(0,u.BX)("span",{css:I.collapsibleSectionHeader,children:[(0,u.tZ)(b.Z,{id:"wDwAdX",defaultMessage:"Description"})," ",!a&&(0,u.tZ)(m.zxk,{type:"link",onClick:()=>i(!0),children:(0,u.tZ)(b.Z,{id:"2YEXRM",defaultMessage:"Edit"})})]}),forceOpen:a,defaultCollapsed:!r,"data-test-id":"experiment-notes-section",children:(0,u.tZ)(k.U,{defaultMarkdown:r,onSubmit:l,onCancel:()=>i(!1),showEditor:a})})})),I={collapsibleSectionHeader:{height:"32px",lineHeight:"32px"}};var L=r(81590);const A=e=>{let{experiment:t}=e;const r=(0,a.Z)();return(0,u.tZ)(m.ZT$.Text,{size:"xl",dangerouslySetAntdProps:{copyable:{text:t.name,icon:(0,u.tZ)(m.TIy,{}),tooltips:[r.formatMessage({id:"A7R0ii",defaultMessage:"Copy path"}),r.formatMessage({id:"JCboZ7",defaultMessage:"Path copied"})]}}})},D=e=>{let{copyText:t}=e;const[r,a]=(0,n.useState)(!1);return(0,u.tZ)(m.ua7,{title:(0,u.tZ)(b.Z,{id:"X+boXI",defaultMessage:"Copied"}),dangerouslySetAntdProps:{visible:r},children:(0,u.tZ)(m.zxk,{type:"primary",onClick:()=>{navigator.clipboard.writeText(t),a(!0),setTimeout((()=>{a(!1)}),3e3)},onMouseLeave:()=>{a(!1)},children:(0,u.tZ)(b.Z,{id:"1Iq+NW",defaultMessage:"Copy"})})})};var N={name:"490tlg",styles:"display:flex;gap:4px"};const O=e=>{let{copyText:t}=e;return(0,u.BX)("div",{css:N,children:[(0,u.tZ)(m.IIB,{readOnly:!0,value:t,"data-test-id":"copy-box"}),(0,u.tZ)(D,{copyText:t})]})},P=e=>{let{visible:t,onCancel:r,link:n}=e;return(0,u.tZ)(m.u_l,{title:(0,u.tZ)(b.Z,{id:"ktiuki",defaultMessage:"Get Link"}),visible:t,onCancel:r,children:(0,u.tZ)(O,{copyText:n})})},U=()=>{const[e,t]=(0,n.useState)(!1);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(P,{link:window.location.href,visible:e,onCancel:()=>t(!1)}),(0,u.tZ)(m.zxk,{type:"primary",onClick:()=>t(!0),"data-test-id":"share-button",children:(0,u.tZ)(b.Z,{id:"2oFAO4",defaultMessage:"Share"})})]})};var H=r(50665),_=r(11310);var F={name:"ny5p0o",styles:"margin-left:16px"},X={name:"158icaa",styles:"margin-left:4px"};const K=n.memo((e=>{let{experiment:t}=e;const r=(0,n.useMemo)((()=>t.name.split("/").pop()),[t.name]),a=(0,_.E)();return(0,u.tZ)(L.mr,{title:(0,u.BX)("div",{css:W.headerWrapper,children:[r," ",(0,u.tZ)(A,{experiment:t})," ",Boolean((0,H.cV)()&&a)&&(0,u.BX)("a",{href:a,target:"_blank",rel:"noreferrer",children:[(0,u.tZ)(m.zxk,{css:F,type:"link",size:"small",children:(0,u.tZ)(b.Z,{id:"d78wwA",defaultMessage:"Provide Feedback"})}),(0,u.tZ)(m.mb1,{css:X})]})]}),breadcrumbs:[],children:(0,u.tZ)(U,{})})})),W={sendFeedbackPopoverContent:{display:"flex",maxWidth:250,flexDirection:"column",alignItems:"flex-end"},headerWrapper:e=>({display:"inline-flex",gap:e.spacing.sm,alignItems:"center"})},z=n.memo((e=>{let{experiments:t}=e;const r=(0,n.useMemo)((()=>(0,u.tZ)(b.Z,{id:"Dhn7Mb",defaultMessage:"Displaying Runs from {numExperiments} Experiments",values:{numExperiments:t.length}})),[t.length]);return(0,u.tZ)(L.mr,{title:r,breadcrumbs:[],children:(0,u.tZ)(U,{})})}));let $=function(e){return e.ACTIVE="Active",e.DELETED="Deleted",e}({}),V=function(e){return e.WITH_MODEL_VERSIONS="With Model Versions",e.WTIHOUT_MODEL_VERSIONS="Without Model Versions",e.ALL_RUNS="All Runs",e}({});var j=r(57293);const Y=(e,t)=>{const{experiments:r}=t,n=r.map((e=>e.experiment_id)),a=n.length>1,i=Object.values(e.entities.runInfosByUuid).filter((e=>{let{experiment_id:t}=e;return n.includes(t)})).map((e=>{let{run_uuid:t}=e;return t})),{modelVersionsByRunUuid:s,runUuidsMatchingFilter:o}=e.entities,l=((e,t,r)=>{let{lifecycleFilter:n=$.ACTIVE,modelVersionFilter:a=V.ALL_RUNS}=r;const{modelVersionsByRunUuid:i}=t.entities;return e.map((e=>(0,w.hQ)(e,t))).filter((e=>n===$.ACTIVE?"active"===e.lifecycle_stage:"deleted"===e.lifecycle_stage)).filter((e=>a===V.ALL_RUNS||(a===V.WITH_MODEL_VERSIONS?e.run_uuid in i:a===V.WTIHOUT_MODEL_VERSIONS?!(e.run_uuid in i):(console.warn("Invalid input to model version filter - defaulting to showing all runs."),!0))))})(i,e,t),c=new Set,d=new Set,u=l.map((t=>{const r=(0,j.nQ)(t.run_uuid,e),n=Object.values(r||{});return n.forEach((e=>{c.add(e.key)})),n})),p=l.map((t=>{const r=Object.values((0,w.Qf)(t.run_uuid,e));return r.forEach((e=>{d.add(e.key)})),r})),h=l.map((t=>(0,w.Ml)(t.run_uuid,e))),m=n[0];return{modelVersionsByRunUuid:s,experimentTags:a?{}:(0,w.aq)(m,e),runInfos:l,paramsList:p,tagsList:h,metricsList:u,runUuidsMatchingFilter:o,metricKeyList:Array.from(c.values()).sort(),paramKeyList:Array.from(d.values()).sort()}};var q=r(71247);class G extends n.Component{handleSortBy(){const{canonicalSortKey:e,orderByAsc:t,orderByKey:r}=this.props;let n=!t;e!==r&&(n=!1),this.props.onSortBy(e,n)}render(){const{enableSorting:e,canonicalSortKey:t,displayName:r,getClassName:n=(()=>""),orderByKey:a,orderByAsc:i}=this.props;return(0,u.BX)("div",{role:"columnheader",css:Q.headerLabelWrapper(e),className:n(t),onClick:e?()=>this.handleSortBy():void 0,children:[(0,u.tZ)("span",{"data-test-id":`sort-header-${r}`,children:r}),e&&t===a?i?(0,u.tZ)(m.TV4,{}):(0,u.tZ)(m.mcG,{}):null]})}}const Q={headerLabelWrapper:e=>t=>({height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 12px",svg:{color:t.colors.textSecondary},"&:hover":{color:e?t.colors.actionTertiaryTextHover:"unset",svg:{color:t.colors.actionTertiaryTextHover}}}),headerSortIcon:{marginRight:4}},J=()=>(0,u.tZ)(m.oOx,{css:e=>({color:e.colors.textValidationDanger})}),ee=()=>(0,u.tZ)(m.rE2,{css:e=>({color:e.colors.textValidationSuccess})}),te=e=>{switch(e){case"FAILED":case"KILLED":return(0,u.tZ)(J,{});case"FINISHED":return(0,u.tZ)(ee,{});case"SCHEDULED":return(0,u.tZ)(m.T39,{});default:return null}},re=n.memo((e=>{let{value:{startTime:t,referenceTime:r,runStatus:n}}=e;return(0,u.BX)("span",{css:ne.cellWrapper,title:s.Z.formatTimestamp(t),children:[te(n),s.Z.timeSinceStr(t,r)]})})),ne={cellWrapper:e=>({display:"flex",alignItems:"center",gap:e.spacing.sm,svg:{width:14,height:14}})};var ae=r(11386),ie=r(9515);const se=n.memo((e=>{let{data:t,value:r}=e;return(0,u.tZ)(ae.rU,{to:ie.Z.getExperimentPageRoute(t.experimentId),title:r.name,children:r.basename})})),oe=e=>{let{text:t,maxSize:r,className:a,allowShowMore:i=!1}=e;if(t.length<=r)return(0,u.tZ)("span",{className:a,children:t});const s=`${t.substr(0,r)}...`,[o,l]=(0,n.useState)(!1);return(0,u.BX)("span",{className:a,children:[o?t:s,i&&(0,u.tZ)(m.zxk,{type:"link",onClick:()=>l(!o),size:"small",css:le.expandButton,"data-test-id":"trimmed-text-button",children:o?"collapse":"expand"})]})},le={expandButton:{display:"inline-block"}};var ce=r.p+"static/media/logged-model.dd9b21ff4fb07f3cadeada8046a2693b.svg";var de=r.p+"static/media/registered-model.24429a4f6158e57b01b3928e2605aa25.svg",ue=r(48685);const pe=n.memo((e=>{const{registeredModels:t,loggedModels:r,experimentId:n,runUuid:a}=e.value,i=s.Z.mergeLoggedAndRegisteredModels(r,t);if(i&&i.length){const e=i[0];let t;if(e.registeredModelName){const{registeredModelName:r,registeredModelVersion:n}=e;t=(0,u.BX)(u.HY,{children:[(0,u.tZ)("img",{"data-test-id":"registered-model-icon",alt:"",title:"Registered Model",src:de}),(0,u.BX)("a",{href:s.Z.getIframeCorrectedRoute((0,ue.u5)(r,n)),className:"registered-model-link",target:"_blank",rel:"noreferrer",children:[(0,u.tZ)(oe,{text:r,maxSize:10,className:"model-name"}),`/${n}`]})]})}else if(e.flavors){const r=e.flavors?e.flavors[0]:"Model",i=s.Z.getIframeCorrectedRoute(`${ie.Z.getRunPageRoute(n,a)}/artifactPath/${e.artifactPath}`);t=(0,u.BX)(u.HY,{children:[(0,u.tZ)("img",{"data-test-id":"logged-model-icon",alt:"",title:"Logged Model",src:ce}),(0,u.tZ)("a",{href:i,target:"_blank",className:"logged-model-link",children:r})]})}return(0,u.BX)("div",{className:"logged-model-cell",css:he.imageWrapper,children:[t,r.length>1?`, ${r.length-1} more`:""]})}return(0,u.tZ)(u.HY,{children:"-"})})),he={imageWrapper:{img:{height:"15px",position:"relative",marginRight:"4px"}}},me=n.memo((e=>{let{value:t}=e;const r=s.Z.renderSource(t,void 0,void 0);return r?(0,u.BX)(u.HY,{children:[s.Z.renderSourceTypeIcon(t),r]}):(0,u.tZ)(u.HY,{children:"-"})})),ge=n.memo((e=>{let{value:{version:t,name:r,type:n}}=e;return s.Z.renderSourceVersion(t,r,n)||(0,u.tZ)(u.HY,{children:"-"})}));var ve=r(93343);const{formatTimestamp:fe,getDuration:ye,getRunNameFromTags:xe,getSourceType:Ce,getSourceName:be,getUser:Ze}=s.Z,Ee=e=>e.reduce(((e,t)=>({...e,[t.key]:t})),{}),Re=e=>void 0===e?"":/[,"\r\n]/.test(e)?'"'+e.replace(/"/g,'""')+'"':e,Se=e=>{const{runInfos:t,paramKeyList:r,metricKeyList:n,tagKeyList:a,paramsList:i,metricsList:s,tagsList:o}=e;return((e,t)=>{let r,n="";for(r=0;r<e.length;r++)n+=Re(e[r]),r<e.length-1&&(n+=",");for(n+="\n",r=0;r<t.length;r++){for(let e=0;e<t[r].length;e++)n+=Re(t[r][e]),e<t[r].length-1&&(n+=",");n+="\n"}return n})(["Start Time","Duration","Run ID","Name","Source Type","Source Name","User","Status",...r,...n,...a],t.map(((e,t)=>{const l=[fe(e.start_time),ye(e.start_time,e.end_time)||"",e.run_uuid,e.run_name||xe(o[t]),Ce(o[t]),be(o[t]),Ze(e,o[t]),e.status],c=Ee(i[t]),d=Ee(s[t]),u=o[t];return r.forEach((e=>{c[e]?l.push(c[e].value):l.push("")})),n.forEach((e=>{d[e]?l.push(d[e].value):l.push("")})),a.forEach((e=>{u[e]?l.push(u[e].value):l.push("")})),l})))},ke="$$$param$$$",we="$$$metric$$$",Me="$$$tag$$$",Te="mlflow.parentRunId";let Be=function(e){return e.SHOWALL="SHOWALL",e.HIDEALL="HIDEALL",e}({});const Ie=(e,t)=>{let r="";return(t.includes('"')||t.includes(" ")||t.includes("."))&&(r="`"),t.includes("`")&&(r='"'),`${e}.${r}${t}${r}`},Le={mouseEnterDelay:0,mouseLeaveDelay:0},Ae=n.memo((e=>{const{pinned:t,hidden:r}=e.value;return(0,u.BX)("div",{css:De.actionsContainer,children:[(0,H.cV)()&&(0,u.tZ)(m.ua7,{dangerouslySetAntdProps:Le,placement:"right",title:r?(0,u.tZ)(b.Z,{id:"xmpvlI",defaultMessage:"Unhide run"}):(0,u.tZ)(b.Z,{id:"qTjYVU",defaultMessage:"Hide run"}),children:(0,u.BX)("label",{css:De.actionCheckbox,className:"is-visibility-toggle",children:[(0,u.tZ)("input",{type:"checkbox",checked:!r,onChange:()=>{e.onToggleVisibility(e.data.runUuid)}}),r?(0,u.tZ)(m.wJG,{}):(0,u.tZ)(m.bMb,{})]})}),e.data.pinnable&&(0,u.tZ)(m.ua7,{dangerouslySetAntdProps:Le,placement:"right",title:t?(0,u.tZ)(b.Z,{id:"ugm2f6",defaultMessage:"Unpin run"}):(0,u.tZ)(b.Z,{id:"fjiojF",defaultMessage:"Pin run"}),children:(0,u.BX)("label",{css:De.actionCheckbox,className:"is-pin-toggle","data-testid":"column-pin-toggle",children:[(0,u.tZ)("input",{type:"checkbox",checked:t,onChange:()=>{e.onTogglePin(e.data.runUuid)}}),t?(0,u.tZ)(m.D$V,{}):(0,u.tZ)(m.qQX,{})]})})]})}),((e,t)=>e.value.hidden===t.value.hidden&&e.value.pinned===t.value.pinned)),De={actionsContainer:()=>({display:"flex",gap:18}),actionCheckbox:e=>({input:{width:0,appearance:"none"},cursor:"pointer",display:"flex",svg:{width:14,height:14,cursor:"pointer"},"&.is-pin-toggle svg":{color:"transparent",".ag-row:hover &":{color:e.colors.grey600}},"&.is-visibility-toggle svg":{color:e.colors.grey400,".ag-row:hover &":{color:e.colors.grey600}},"& input:checked + span svg":{color:e.colors.grey600}})},Ne=n.memo((e=>(0,u.BX)(m.h_2.Root,{modal:!1,children:[(0,u.tZ)(m.h_2.Trigger,{asChild:!0,children:(0,u.tZ)("button",{css:Oe.actionButton,"data-testid":"experiment-view-runs-visibility-column-header",children:(0,u.tZ)(m.bMb,{})})}),(0,u.BX)(m.h_2.Content,{children:[(0,u.BX)(m.h_2.Item,{onClick:()=>e.onToggleVisibility(Be.HIDEALL),"data-testid":"experiment-view-runs-visibility-hide-all",children:[(0,u.tZ)(m.h_2.IconWrapper,{children:(0,u.tZ)(m.wJG,{})}),(0,u.tZ)(b.Z,{id:"UEESlL",defaultMessage:"Hide all runs"})]}),(0,u.BX)(m.h_2.Item,{onClick:()=>e.onToggleVisibility(Be.SHOWALL),"data-testid":"experiment-view-runs-visibility-show-all",children:[(0,u.tZ)(m.h_2.IconWrapper,{children:(0,u.tZ)(m.bMb,{})}),(0,u.tZ)(b.Z,{id:"4yjF8O",defaultMessage:"Show all runs"})]})]})]}))),Oe={actionButton:e=>({background:"transparent",border:"none",cursor:"pointer",padding:"8px",".ag-checkbox:not(.ag-hidden) + &":{padding:"0 1px"},svg:{width:14,height:14,cursor:"pointer",color:e.colors.grey600}})},Pe=n.memo((e=>{let{onExpand:t,data:{runName:r,experimentId:n,runUuid:a,runDateAndNestInfo:i,color:s}}=e;const{hasExpander:o,expanderOpen:l,childrenIds:c,level:d}=i||{},p=!isNaN(d)&&o,h=(0,H.cV)();return(0,u.BX)("div",{css:Ue.cellWrapper,children:[(0,u.tZ)("div",{css:Ue.expanderWrapper,children:(0,u.tZ)("div",{css:Ue.nestLevel(d),children:p&&(0,u.tZ)(m.zxk,{css:Ue.expanderButton,size:"small",onClick:()=>{t(a,c)},type:"link",icon:l?(0,u.tZ)(m.uSo,{}):(0,u.tZ)(m.IAe,{})},"Expander-"+a)})}),(0,u.BX)(ae.rU,{to:ie.Z.getRunPageRoute(n,a),css:Ue.runLink,children:[h&&(0,u.tZ)("div",{css:Ue.colorPill,"data-testid":"experiment-view-table-run-color",style:{backgroundColor:s}}),(0,u.tZ)("span",{css:Ue.runName,children:r})]})]})})),Ue={link:e=>({display:"inline-block",minWidth:e.typography.fontSizeBase,minHeight:e.typography.fontSizeBase}),cellWrapper:{display:"flex"},expanderButton:{svg:{width:12,height:12}},runLink:{overflow:"hidden",display:"flex",gap:8,alignItems:"center"},runName:{overflow:"hidden",textOverflow:"ellipsis"},expanderWrapper:{display:"none",".ag-grid-expanders-visible &":{display:"block"}},colorPill:{width:12,height:12,borderRadius:6,flexShrink:0,"@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)":{marginBottom:1}},nestLevel:e=>t=>({display:"flex",justifyContent:"flex-end",width:(e+1)*t.spacing.lg,height:t.spacing.lg})};var He={name:"gikiyg",styles:"display:flex;justify-content:center;align-items:center;height:32px"};const _e=n.memo((e=>{let{loadMoreRunsFunc:t}=e;return(0,u.tZ)("div",{css:He,children:(0,u.tZ)(m.zxk,{type:"primary",onClick:t,size:"small",children:(0,u.tZ)(b.Z,{id:"9CqEWy",defaultMessage:"Load more"})})})})),Fe=e=>(0,H.cV)()?e?70:104:70,Xe=(e,t)=>e+".`"+t+"`",Ke=(e,t)=>e.startsWith(t),We=(e,t)=>e.substring(t.length+2).slice(0,-1),ze=e=>`$$$param$$$-${e}`,$e=e=>`$$$metric$$$-${e}`,Ve=e=>`$$$tag$$$-${e}`,je={[q.XZ.USER]:Xe(q.D5.ATTRIBUTES,"User"),[q.XZ.RUN_NAME]:Xe(q.D5.ATTRIBUTES,"Run Name"),[q.XZ.SOURCE]:Xe(q.D5.ATTRIBUTES,"Source"),[q.XZ.VERSION]:Xe(q.D5.ATTRIBUTES,"Version")},Ye=e=>{let{data:t}=e;return t.runUuid},qe=e=>{let{rowNode:t}=e;return t.data.isLoadMoreRow},Ge=[q.z.USER,q.z.SOURCE,q.z.VERSION,q.z.MODELS],Qe=[q.z.EXPERIMENT_NAME,...Ge],Je=e=>{let{searchFacetsState:t,onSortBy:r,compareExperiments:a,onTogglePin:i,onToggleVisibility:l,onExpand:c,paramKeyList:d,metricKeyList:u,tagKeyList:p,columnApi:h,isComparingRuns:m}=e;const{orderByAsc:g,orderByKey:v,selectedColumns:f}=t,y=(e=>{let{paramKeyList:t,metricKeyList:r,tagKeyList:a}=e;const i=(0,n.useRef)(new Set),s=(0,n.useRef)(new Set),o=(0,n.useRef)(new Set),l=(0,n.useMemo)((()=>(t.forEach((e=>s.current.add(e))),Array.from(s.current))),[t]),c=(0,n.useMemo)((()=>(r.forEach((e=>i.current.add(e))),Array.from(i.current))),[r]),d=(0,n.useMemo)((()=>(a.forEach((e=>o.current.add(e))),Array.from(o.current))),[a]);return(0,n.useMemo)((()=>({paramKeys:l,metricKeys:c,tagKeys:d})),[c,l,d])})({metricKeyList:u,tagKeyList:p,paramKeyList:d}),x=(0,n.useMemo)((()=>{const e={orderByKey:v,orderByAsc:g,onSortBy:r},t=e=>e===v?"is-ordered-by":void 0,n=e=>t(e),d=e=>{let{colDef:r}=e;return t(r.headerComponentParams.canonicalSortKey)},u=[];if(u.push({valueGetter:e=>{let{data:{pinned:t,hidden:r}}=e;return{pinned:t,hidden:r}},checkboxSelection:!m,headerComponent:(0,H.cV)()?"RowActionsHeaderCellRenderer":void 0,headerComponentParams:{onToggleVisibility:l},headerCheckboxSelection:!m,headerName:"",cellClass:"is-checkbox-cell",cellRenderer:"RowActionsCellRenderer",cellRendererParams:{onTogglePin:i,onToggleVisibility:l},pinned:"left",minWidth:Fe(m),width:Fe(m),maxWidth:Fe(m),resizable:!1}),u.push({headerName:q.z.RUN_NAME,colId:je[q.XZ.RUN_NAME],headerTooltip:q.XZ.RUN_NAME,pinned:"left",sortable:!0,field:"runDateAndNestInfo",cellRenderer:"RunNameCellRenderer",cellRendererParams:{onExpand:c},equals:(e,t)=>(0,o.isEqual)(e,t),headerComponentParams:{...e,canonicalSortKey:q.XZ.RUN_NAME,getClassName:n},cellClass:d,initialWidth:(0,H.cV)()?310:260,resizable:!m}),m)return u;u.push({headerName:q.z.DATE,headerTooltip:q.XZ.DATE,pinned:"left",sortable:!0,field:"runDateAndNestInfo",cellRenderer:"DateCellRenderer",cellRendererParams:{onExpand:c},equals:(e,t)=>(0,o.isEqual)(e,t),headerComponentParams:{...e,canonicalSortKey:q.XZ.DATE,getClassName:n},cellClass:d,initialWidth:150}),u.push({headerName:q.z.DURATION,field:"duration",initialWidth:80,cellClass:d}),a&&u.push({headerName:q.z.EXPERIMENT_NAME,colId:Xe(q.D5.ATTRIBUTES,q.z.EXPERIMENT_NAME),field:"experimentName",cellRenderer:"ExperimentNameCellRenderer",equals:(e,t)=>(0,o.isEqual)(e,t),initialWidth:140,cellClass:d,initialHide:!0}),u.push({headerName:q.z.USER,colId:je[q.XZ.USER],headerTooltip:q.XZ.USER,field:"user",sortable:!0,headerComponentParams:{...e,canonicalSortKey:q.XZ.USER,getClassName:n},cellClass:d,initialHide:!0}),u.push({headerName:q.z.SOURCE,colId:je[q.XZ.SOURCE],field:"tags",cellRenderer:"SourceCellRenderer",equals:(e,t)=>s.Z.getSourceName(e)===s.Z.getSourceName(t),sortable:!0,headerComponentParams:{...e,canonicalSortKey:q.XZ.SOURCE,getClassName:n},cellClass:d,initialHide:!0}),u.push({headerName:q.z.VERSION,colId:je[q.XZ.VERSION],field:"version",cellRenderer:"VersionCellRenderer",equals:(e,t)=>(0,o.isEqual)(e,t),sortable:!0,headerComponentParams:{...e,canonicalSortKey:q.XZ.VERSION,getClassName:n},cellClass:d,initialHide:!0}),u.push({headerName:q.z.MODELS,colId:Xe(q.D5.ATTRIBUTES,q.z.MODELS),field:"models",cellRenderer:"ModelsCellRenderer",initialWidth:200,equals:(e,t)=>(0,o.isEqual)(e,t),initialHide:!0});const{metricKeys:p,paramKeys:h,tagKeys:f}=y;return p.length&&u.push({headerName:"Metrics",colId:q.D5.METRICS,children:p.map((t=>{const r=Xe(q.D5.METRICS,t);return{headerName:t,colId:r,headerTooltip:Ie(q.D5.METRICS,t),field:$e(t),tooltipField:$e(t),initialWidth:100,initialHide:!0,sortable:!0,headerComponentParams:{...e,canonicalSortKey:r,getClassName:n},cellClass:d}}))}),h.length&&u.push({headerName:"Parameters",colId:q.D5.PARAMS,children:h.map((t=>{const r=Xe(q.D5.PARAMS,t);return{colId:r,headerName:t,headerTooltip:Ie(q.D5.PARAMS,t),field:ze(t),tooltipField:ze(t),initialHide:!0,initialWidth:100,sortable:!0,headerComponentParams:{...e,canonicalSortKey:r,getClassName:n},cellClass:d}}))}),f.length&&u.push({headerName:"Tags",colId:q.D5.TAGS,children:f.map((e=>({colId:Xe(q.D5.TAGS,e),headerName:e,initialHide:!0,initialWidth:100,headerTooltip:Ie(q.D5.TAGS,e),field:Ve(e),tooltipField:Ve(e)})))}),u}),[v,g,r,i,l,c,a,y,m]),C=(0,n.useMemo)((()=>[...Qe.map((e=>Xe(q.D5.ATTRIBUTES,e))),...y.paramKeys.map((e=>Xe(q.D5.PARAMS,e))),...y.metricKeys.map((e=>Xe(q.D5.METRICS,e))),...y.tagKeys.map((e=>Xe(q.D5.TAGS,e)))]),[y]);return(0,n.useEffect)((()=>{if(h&&!m)for(const e of C){const t=f.includes(e);h.setColumnVisible(e,t)}}),[f,h,C,m]),x},et={initialWidth:100,autoSizePadding:0,headerComponentParams:{menuIcon:"fa-bars"},resizable:!0,filter:!0,suppressMenu:!0,suppressMovable:!0};var tt=r(17946),rt=r(48091);class nt extends n.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(){const e=[];return this.props.selectedRunIds.forEach((t=>{e.push(this.props.deleteRunApi(t))})),Promise.all(e).catch((()=>{this.props.openErrorModal("While deleting an experiment run, an error occurred.")}))}render(){const e=this.props.selectedRunIds.length;return(0,u.tZ)(rt.s,{isOpen:this.props.isOpen,onClose:this.props.onClose,handleSubmit:this.handleSubmit,title:`Delete Experiment ${s.Z.pluralize("Run",e)}`,helpText:(0,u.BX)("div",{children:[(0,u.tZ)("p",{children:(0,u.BX)("b",{children:[e," experiment ",s.Z.pluralize("run",e)," will be deleted."]})}),""]}),confirmButtonText:"Delete"})}}const at={deleteRunApi:i.Gd,openErrorModal:i.yQ};var it=(0,c.$j)(null,at)(nt),st=r(14915);class ot extends n.Component{constructor(e){super(e),this.handleSubmit=this.handleSubmit.bind(this)}handleSubmit(){const e=[];return this.props.selectedRunIds.forEach((t=>{e.push(this.props.restoreRunApi(t))})),Promise.all(e).catch((e=>{let t="While restoring an experiment run, an error occurred.";e.textJson&&"RESOURCE_LIMIT_EXCEEDED"===e.textJson.error_code&&(t=t+" "+e.textJson.message),this.props.openErrorModal(t)}))}render(){const e=this.props.selectedRunIds.length;return(0,u.tZ)(rt.s,{isOpen:this.props.isOpen,onClose:this.props.onClose,handleSubmit:this.handleSubmit,title:`Restore Experiment ${s.Z.pluralize("Run",e)}`,helpText:`${e} experiment ${s.Z.pluralize("run",e)} will be restored.`,confirmButtonText:"Restore"})}}const lt={restoreRunApi:i.Y1,openErrorModal:i.yQ};var ct=(0,c.$j)(null,lt)(ot),dt=r(4336),ut=r.n(dt);const pt=()=>{var e;const t=(0,tt.$B)(),r=(0,tt.TH)(),a=(0,n.useMemo)((()=>decodeURIComponent(r.search)),[r.search]),i=(0,n.useMemo)((()=>{const e=ut().parse(a.substring(1));if(e.experiments){const t=e.experiments;return(null===t||void 0===t?void 0:t.toString())||""}return""}),[a]);return(0,n.useMemo)((()=>{var e,r;if(null!==(e=t.params)&&void 0!==e&&e.experimentId)return[null===(r=t.params)||void 0===r?void 0:r.experimentId];if(i)try{return JSON.parse(i)}catch{return s.Z.logErrorAndNotifyUser(`Could not parse experiment query parameter ${i}`),""}return[]}),[i,null===(e=t.params)||void 0===e?void 0:e.experimentId])};var ht=r(92885),mt=r(36639);const gt={ALL:null,LAST_HOUR:36e5,LAST_24_HOURS:864e5,LAST_7_DAYS:6048e5,LAST_30_DAYS:2592e6,LAST_YEAR:31104e6},vt=(e,t)=>!(0,o.isEqual)(e.searchFilter,t.searchFilter)||!(0,o.isEqual)(e.orderByAsc,t.orderByAsc)||!(0,o.isEqual)(e.orderByKey,t.orderByKey)||!(0,o.isEqual)(e.lifecycleFilter,t.lifecycleFilter)||!(0,o.isEqual)(e.startTime,t.startTime),ft=(e,t,r,n)=>{const a=t.lifecycleFilter===$.ACTIVE?mt.bW.ACTIVE_ONLY:mt.bW.DELETED_ONLY,{runsPinned:i}=t,s=(e=>{let{orderByKey:t,orderByAsc:r}=e;return t?r?[t+" ASC"]:[t+" DESC"]:[]})(t),o=((e,t)=>{let{startTime:r}=e;const n=gt[r];return r&&n&&"ALL"!==r?"attributes.start_time >= "+(t-n):null})(t,r),l=((e,t)=>{let{searchFilter:r}=e;return r&&t?`${r} and ${t}`:!r&&t?t:r||void 0})(t,o),c=(e=>{let{orderByKey:t,searchFilter:r}=e;return!t&&!r||t===q.XZ.DATE})(t);return{experimentIds:e,filter:l,runViewType:a,orderBy:s,shouldFetchParents:c,pageToken:n,runsPinned:i}},yt=(e,t,r)=>{const n=e.filter((e=>e.data.tags.some((e=>"mlflow.log-model.history"===e.key))));(0,o.chunk)(n,ht.mc).forEach((e=>{const n=t({run_id:e.map((e=>e.info.run_id))});r(n)}))};var xt=r(98912);const Ct=[Xe(q.D5.ATTRIBUTES,q.z.SOURCE),Xe(q.D5.ATTRIBUTES,q.z.MODELS)],bt=e=>{const{lifecycleFilter:t,modelVersionFilter:r,searchFilter:n,startTime:a,orderByAsc:i,orderByKey:s}=new Et;return{...e,lifecycleFilter:t,modelVersionFilter:r,searchFilter:n,startTime:a,orderByAsc:i,orderByKey:s}},Zt=e=>{const{lifecycleFilter:t,modelVersionFilter:r,searchFilter:n,startTime:a}=e;return Boolean(t!==q.FJ||r!==q.oj||n||a!==q.wi)};class Et{constructor(){this.searchFilter="",this.orderByKey=q.gB,this.orderByAsc=q.yG,this.startTime=q.wi,this.lifecycleFilter=q.FJ,this.modelVersionFilter=q.oj,this.selectedColumns=[...Ct],this.runsExpanded={},this.runsPinned=[],this.runsHidden=[],this.isComparingRuns=!1,this.compareRunCharts=void 0}}var Rt=r(59590);const St=e=>(0,o.isArray)(e)?e.join():e,kt={searchFilter:{deserializeLocalStorage:St,deserializeQueryString:St},compareRunCharts:{serializeQueryString:e=>(0,Rt.g4)(JSON.stringify(e)),deserializeQueryString(e){try{const t=JSON.parse((0,Rt.DL)(e));if(!Array.isArray(t))return;return t}catch{return}}},isComparingRuns:{serializeLocalStorage:()=>!1}},wt=()=>(0,H.cV)(),Mt=Object.keys(new Et),Tt=(e,t,r,n)=>{if("value"===n){if("true"===e)return!0;if("false"===e)return!1;if(void 0===e)return""}return t(e)},Bt=(e,t)=>Object.assign(new Et,{...e,...t});function It(e,t){const r=xt.Z.getStoreForComponent("ExperimentPage",t),n=wt()?(e=>{const t={...e};for(const n of Object.keys(t)){var r;const e=null===(r=kt[n])||void 0===r?void 0:r.serializeLocalStorage;e&&(t[n]=e(t[n]))}return t})(e):e;r.saveComponentState(n)}function Lt(e){const t=wt()?(e=>{const t={...e};for(const n of Object.keys(t)){var r;const e=null===(r=kt[n])||void 0===r?void 0:r.serializeQueryString;e&&(t[n]=e(t[n]))}return t})(e):e;return ut().stringify(t,{addQueryPrefix:!0,arrayFormat:"comma",encodeValuesOnly:!0})}function At(e,t){let r=new Et;try{const e=xt.Z.getStoreForComponent("ExperimentPage",t).loadComponentState();if((!(n=e).runsExpanded||(0,o.isObject)(n.runsExpanded))&&(!n.selectedColumns||(0,o.isArray)(n.selectedColumns))){const t=wt()?(e=>{const t={...e};for(const n of Object.keys(t)){var r;const e=null===(r=kt[n])||void 0===r?void 0:r.deserializeLocalStorage;e&&(t[n]=e(t[n]))}return t})(e):e;r=Bt(r,t)}}catch{s.Z.logErrorAndNotifyUser(`Error: malformed persisted search state for experiment(s) ${t}`)}var n;const a=decodeURIComponent(e),i=ut().parse(a,{ignoreQueryPrefix:!0,comma:!0,arrayLimit:500,decoder:Tt}),{restData:l,stateData:c}=function(e){const t={},r={};for(const n in e)if(e.hasOwnProperty(n)){const a=Mt.includes(n);Object.assign(a?t:r,{[n]:e[n]})}return{stateData:t,restData:r}}(i),d=wt()?(e=>{const t={...e};for(const n of Object.keys(t)){var r;const e=null===(r=kt[n])||void 0===r?void 0:r.deserializeQueryString;e&&(t[n]=e(t[n]))}return t})(c):c;if(!(Object.keys(d).length<1)){const e=Object.assign(new Et,d);r=Bt(r,e)}return It(r,t),(0,H.cV)()||(r.isComparingRuns=!1),{state:r,queryString:Lt({...l,...r})}}const Dt=(0,n.createContext)(null),Nt=e=>{let{children:t,actions:r}=e;const a=(0,tt.k6)(),i=pt(),c=d(),[p,h]=(0,n.useState)(""),[m,g]=(0,n.useState)(!1),[v,f]=(0,n.useState)(!1),[y,x]=(0,n.useState)(null),C=(0,n.useMemo)((()=>JSON.stringify(i.sort())),[i]),[b,Z]=(0,n.useState)((()=>{const{queryString:e,state:t}=At(a.location.search,C);return a.location.search!==e&&a.replace(`${a.location.pathname}${e}`),t})),E=(0,n.useRef)([]),R=(0,n.useRef)(""),S=(0,n.useRef)(""),k=(0,n.useRef)(!0),w=(0,n.useCallback)((()=>k.current),[]),M=(0,n.useCallback)((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),a=arguments.length>3?arguments[3]:void 0;const i=Boolean(a);i||(S.current=n);const o=i?r.loadMoreRunsApi:r.searchRunsApi,l=o(ft(t,e,n,a||void 0));g(!0);const d=c(l).then((e=>{const{value:t}=e;return R.current=t.next_page_token,f(Boolean(t.next_page_token)),yt(t.runs||[],r.searchModelVersionsApi,c),E.current.some((e=>e.id===l.meta.id&&!e.active))&&g(!1),t.runs||[]})).catch((e=>{s.Z.logErrorAndNotifyUser(e,0),g(!1)}));return h(l.meta.id),d}),[c,r]),T=(0,n.useCallback)((()=>M(b,i,S.current||void 0,R.current||void 0)),[M,b,i]),B=(0,n.useCallback)((()=>{M(b,i)}),[i,M,b]),I=(0,n.useCallback)(((e,t)=>{const r=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=ut().parse(r,{ignoreQueryPrefix:!0,comma:!0,arrayLimit:500,decoder:Tt}),{experiments:a}=n;return It(e,t),Lt({experiments:a,...e})}(e,C,a.location.search);if(a.location.search!==r){const e=`${a.location.pathname}${r}`;t?a.replace(e):a.push(e)}}),[a,C]),L=(0,n.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{forceRefresh:r=!1,preservePristine:n=!1,replaceHistory:a=!1}=t;Z((t=>{const n=(0,o.isFunction)(e)?e(t):{...t,...e};return(r||vt(t,n))&&M(n,i),I(n,a),n})),n||(k.current=!1)}),[i,M,I]);(0,n.useEffect)((()=>a.listen(((e,t)=>{if("POP"===t){const{state:t}=At(e.search,C);L(t)}}))),[a,C,L]);const A=(0,n.useMemo)((()=>({actions:r,searchFacetsState:b,fetchExperimentRuns:B,updateSearchFacets:L,loadMoreRuns:T,requestError:y,isLoadingRuns:m,moreRunsAvailable:v,isPristine:w})),[r,b,B,T,y,m,L,v,w]);return(0,u.tZ)(Dt.Provider,{value:A,children:(0,u.tZ)(l.ZP,{shouldOptimisticallyRender:!0,requestIds:p?[p]:[],children:(e,r,n)=>(E.current=n,n.forEach((e=>{x(e.error)})),t)})})},Ot=()=>{const e=(0,n.useContext)(Dt);if(!e)throw new Error("Trying to use SearchExperimentRunsContext actions outside of the context!");return e},Pt=e=>{let{showDeleteRunModal:t,showRestoreRunModal:r,showRenameRunModal:a,runsSelected:i,onCloseDeleteRunModal:s,onCloseRestoreRunModal:o,onCloseRenameRunModal:l,renamedRunName:c}=e;const{updateSearchFacets:d}=Ot(),p=Object.entries(i).filter((e=>{let[,t]=e;return t})).map((e=>{let[t]=e;return t})),h=(0,n.useCallback)((()=>d({},{forceRefresh:!0,preservePristine:!0})),[d]);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(it,{isOpen:t,onClose:s,selectedRunIds:p}),(0,u.tZ)(ct,{isOpen:r,onClose:o,selectedRunIds:p}),(0,u.tZ)(st.UQ,{runUuid:p[0],onClose:l,runName:c,isOpen:a,onSuccess:()=>h()})]})},Ut=e=>{let{children:t}=e;return(0,u.tZ)(u.HY,{children:t})},Ht=n.memo((e=>{let{viewState:t,runsData:r,searchFacetsState:i,updateSearchFacets:s}=e;const{runsSelected:o}=t,{runInfos:l}=r,{lifecycleFilter:c,startTime:d}=i,p=(0,tt.k6)(),h=(0,a.Z)(),g=(0,n.useMemo)((()=>(e=>({ALL:e.formatMessage({id:"a/TbnY",defaultMessage:"All time"}),LAST_HOUR:e.formatMessage({id:"bjoGjg",defaultMessage:"Last hour"}),LAST_24_HOURS:e.formatMessage({id:"JChRnq",defaultMessage:"Last 24 hours"}),LAST_7_DAYS:e.formatMessage({id:"eQsXm7",defaultMessage:"Last 7 days"}),LAST_30_DAYS:e.formatMessage({id:"p1H1KR",defaultMessage:"Last 30 days"}),LAST_YEAR:e.formatMessage({id:"EI7moF",defaultMessage:"Last year"})}))(h)),[h]),[v,f]=(0,n.useState)(!1),[y,x]=(0,n.useState)(!1),[C,Z]=(0,n.useState)(!1),[E,R]=(0,n.useState)(""),S=(0,n.useCallback)((()=>{const e=Object.keys(o),t=l.find((t=>t.run_uuid===e[0]));t&&(R(t.run_name),Z(!0))}),[l,o]),k=(0,n.useCallback)((()=>{const e=Object.keys(o),t=l.filter((t=>{let{run_uuid:r}=t;return e.includes(r)})).map((e=>{let{experiment_id:t}=e;return t}));p.push(ie.Z.getCompareRunPageRoute(e,[...new Set(t)].sort()))}),[p,l,o]),w=(0,n.useCallback)((()=>f(!0)),[]),M=(0,n.useCallback)((()=>x(!0)),[]),T=(0,n.useCallback)((()=>f(!1)),[]),B=(0,n.useCallback)((()=>x(!1)),[]),I=(0,n.useCallback)((()=>Z(!1)),[]),L=Object.values(t.runsSelected).filter(Boolean).length,A=L>0,D=1===L,N=L>1,O=N||D||A,P=(0,u.BX)(u.HY,{children:[(0,u.tZ)(b.Z,{id:"OGWg8l",defaultMessage:"State:"})," ",c]}),U=(0,u.BX)(u.HY,{children:[(0,u.tZ)(b.Z,{id:"+fb25b",defaultMessage:"Time created"}),": ",g[d]]});return(0,u.BX)("div",{css:_t.controlBar,children:[(0,u.tZ)(Pt,{runsSelected:o,onCloseRenameRunModal:I,onCloseDeleteRunModal:T,onCloseRestoreRunModal:B,showDeleteRunModal:v,showRestoreRunModal:y,showRenameRunModal:C,renamedRunName:E}),!O&&(0,u.BX)(u.HY,{children:[(0,u.tZ)(m.PhF,{className:"start-time-select",value:{value:d,label:U},labelInValue:!0,onChange:e=>{let{value:t}=e;s({startTime:t})},"data-test-id":"start-time-select-dropdown",virtual:!1,children:Object.keys(g).map((e=>(0,u.tZ)(m.Wxm,{title:g[e],"data-test-id":`start-time-select-${e}`,value:e,children:g[e]},e)))}),(0,u.BX)(m.PhF,{value:{value:c,label:P},labelInValue:!0,"data-testid":"lifecycle-filter",onChange:e=>{let{value:t}=e;return s({lifecycleFilter:t})},children:[(0,u.tZ)(m.PhF.Option,{"data-testid":"active-runs-menu-item",value:q.VW.ACTIVE,children:(0,u.tZ)(b.Z,{id:"0pdAuV",defaultMessage:"Active"})}),(0,u.tZ)(m.PhF.Option,{"data-testid":"deleted-runs-menu-item",value:q.VW.DELETED,children:(0,u.tZ)(b.Z,{id:"yJpGwW",defaultMessage:"Deleted"})})]})]}),O&&(0,u.BX)(u.HY,{children:[(0,u.tZ)(m.zxk,{"data-testid":"run-rename-button",onClick:S,disabled:!D,children:(0,u.tZ)(b.Z,{id:"oWPgX7",defaultMessage:"Rename"})}),c===q.VW.ACTIVE?(0,u.tZ)(m.zxk,{"data-testid":"runs-delete-button",disabled:!A,onClick:w,danger:!0,children:(0,u.tZ)(b.Z,{id:"3Rb4sG",defaultMessage:"Delete"})}):null,c===q.VW.DELETED?(0,u.tZ)(m.zxk,{"data-testid":"runs-restore-button",disabled:!A,onClick:M,children:(0,u.tZ)(b.Z,{id:"Potju2",defaultMessage:"Restore"})}):null,(0,u.tZ)("div",{css:_t.buttonSeparator}),(0,u.tZ)(Ut,{children:(0,u.tZ)(m.zxk,{"data-testid":"runs-compare-button",disabled:!N,onClick:k,children:(0,u.tZ)(b.Z,{id:"RaGnOQ",defaultMessage:"Compare"})})})]})]})})),_t={groupSeparator:()=>({flex:1}),buttonSeparator:e=>({borderLeft:`1px solid ${e.colors.border}`,marginLeft:e.spacing.xs,marginRight:e.spacing.xs,height:"100%"}),controlBar:e=>({display:"flex",gap:e.spacing.sm,alignItems:"center",paddingTop:e.spacing.sm,borderTop:`1px solid ${e.colors.border}`})};var Ft=r(4942),Xt=r(71002),Kt=r(87462),Wt=r(17427),zt=r(72949),$t=r.n(zt),Vt=r(30584),jt=r(75555),Yt=r(29439);function qt(e){var t,r=e.prefixCls,a=e.value,i=e.current,s=e.offset,o=void 0===s?0:s;return o&&(t={position:"absolute",top:"".concat(o,"00%"),left:0}),n.createElement("span",{style:t,className:$t()("".concat(r,"-only-unit"),{current:i})},a)}function Gt(e,t,r){for(var n=e,a=0;(n+10)%10!==t;)n+=r,a+=r;return a}function Qt(e){var t,r,a=e.prefixCls,i=e.count,s=e.value,o=Number(s),l=Math.abs(i),c=n.useState(o),d=(0,Yt.Z)(c,2),u=d[0],p=d[1],h=n.useState(l),m=(0,Yt.Z)(h,2),g=m[0],v=m[1],f=function(){p(o),v(l)};if(n.useEffect((function(){var e=setTimeout((function(){f()}),1e3);return function(){clearTimeout(e)}}),[o]),u===o||Number.isNaN(o)||Number.isNaN(u))t=[n.createElement(qt,(0,Kt.Z)({},e,{key:o,current:!0}))],r={transition:"none"};else{t=[];for(var y=o+10,x=[],C=o;C<=y;C+=1)x.push(C);var b=x.findIndex((function(e){return e%10===u}));t=x.map((function(t,r){var a=t%10;return n.createElement(qt,(0,Kt.Z)({},e,{key:t,value:a,offset:r-b,current:r===b}))})),r={transform:"translateY(".concat(-Gt(u,o,g<l?1:-1),"00%)")}}return n.createElement("span",{className:"".concat(a,"-only"),style:r,onTransitionEnd:f},t)}var Jt=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},er=function(e){var t=e.prefixCls,r=e.count,a=e.className,i=e.motionClassName,s=e.style,o=e.title,l=e.show,c=e.component,d=void 0===c?"sup":c,u=e.children,p=Jt(e,["prefixCls","count","className","motionClassName","style","title","show","component","children"]),h=(0,n.useContext(Vt.E_).getPrefixCls)("scroll-number",t),m=(0,Kt.Z)((0,Kt.Z)({},p),{"data-show":l,style:s,className:$t()(h,a,i),title:o}),g=r;if(r&&Number(r)%1===0){var v=String(r).split("");g=v.map((function(e,t){return n.createElement(Qt,{prefixCls:h,count:Number(r),value:e,key:v.length-t})}))}return s&&s.borderColor&&(m.style=(0,Kt.Z)((0,Kt.Z)({},s),{boxShadow:"0 0 0 1px ".concat(s.borderColor," inset")})),u?(0,jt.Tm)(u,(function(e){return{className:$t()("".concat(h,"-custom-component"),null===e||void 0===e?void 0:e.className,i)}})):n.createElement(d,m,g)},tr=r(26935);function rr(e){return-1!==tr.Y.indexOf(e)}var nr=function(e){var t,r=e.className,a=e.prefixCls,i=e.style,s=e.color,o=e.children,l=e.text,c=e.placement,d=void 0===c?"end":c,u=n.useContext(Vt.E_),p=u.getPrefixCls,h=u.direction,m=p("ribbon",a),g=rr(s),v=$t()(m,"".concat(m,"-placement-").concat(d),(t={},(0,Ft.Z)(t,"".concat(m,"-rtl"),"rtl"===h),(0,Ft.Z)(t,"".concat(m,"-color-").concat(s),g),t),r),f={},y={};return s&&!g&&(f.background=s,y.color=s),n.createElement("div",{className:"".concat(m,"-wrapper")},o,n.createElement("div",{className:v,style:(0,Kt.Z)((0,Kt.Z)({},f),i)},n.createElement("span",{className:"".concat(m,"-text")},l),n.createElement("div",{className:"".concat(m,"-corner"),style:y})))},ar=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},ir=function(e){var t,r,a=e.prefixCls,i=e.scrollNumberPrefixCls,s=e.children,o=e.status,l=e.text,c=e.color,d=e.count,u=void 0===d?null:d,p=e.overflowCount,h=void 0===p?99:p,m=e.dot,g=void 0!==m&&m,v=e.size,f=void 0===v?"default":v,y=e.title,x=e.offset,C=e.style,b=e.className,Z=e.showZero,E=void 0!==Z&&Z,R=ar(e,["prefixCls","scrollNumberPrefixCls","children","status","text","color","count","overflowCount","dot","size","title","offset","style","className","showZero"]),S=n.useContext(Vt.E_),k=S.getPrefixCls,w=S.direction,M=k("badge",a),T=u>h?"".concat(h,"+"):u,B=null!==o&&void 0!==o||null!==c&&void 0!==c,I="0"===T||0===T,L=g&&!I||B,A=L?"":T,D=(0,n.useMemo)((function(){return(null===A||void 0===A||""===A||I&&!E)&&!L}),[A,I,E,L]),N=(0,n.useRef)(u);D||(N.current=u);var O=N.current,P=(0,n.useRef)(A);D||(P.current=A);var U=P.current,H=(0,n.useRef)(L);D||(H.current=L);var _=(0,n.useMemo)((function(){if(!x)return(0,Kt.Z)({},C);var e={marginTop:x[1]};return"rtl"===w?e.left=parseInt(x[0],10):e.right=-parseInt(x[0],10),(0,Kt.Z)((0,Kt.Z)({},e),C)}),[w,x,C]),F=null!==y&&void 0!==y?y:"string"===typeof O||"number"===typeof O?O:void 0,X=D||!l?null:n.createElement("span",{className:"".concat(M,"-status-text")},l),K=O&&"object"===(0,Xt.Z)(O)?(0,jt.Tm)(O,(function(e){return{style:(0,Kt.Z)((0,Kt.Z)({},_),e.style)}})):void 0,W=$t()((t={},(0,Ft.Z)(t,"".concat(M,"-status-dot"),B),(0,Ft.Z)(t,"".concat(M,"-status-").concat(o),!!o),(0,Ft.Z)(t,"".concat(M,"-status-").concat(c),rr(c)),t)),z={};c&&!rr(c)&&(z.background=c);var $=$t()(M,(r={},(0,Ft.Z)(r,"".concat(M,"-status"),B),(0,Ft.Z)(r,"".concat(M,"-not-a-wrapper"),!s),(0,Ft.Z)(r,"".concat(M,"-rtl"),"rtl"===w),r),b);if(!s&&B){var V=_.color;return n.createElement("span",(0,Kt.Z)({},R,{className:$,style:_}),n.createElement("span",{className:W,style:z}),n.createElement("span",{style:{color:V},className:"".concat(M,"-status-text")},l))}return n.createElement("span",(0,Kt.Z)({},R,{className:$}),s,n.createElement(Wt.Z,{visible:!D,motionName:"".concat(M,"-zoom"),motionAppear:!1},(function(e){var t,r=e.className,a=k("scroll-number",i),s=H.current,l=$t()((t={},(0,Ft.Z)(t,"".concat(M,"-dot"),s),(0,Ft.Z)(t,"".concat(M,"-count"),!s),(0,Ft.Z)(t,"".concat(M,"-count-sm"),"small"===f),(0,Ft.Z)(t,"".concat(M,"-multiple-words"),!s&&U&&U.toString().length>1),(0,Ft.Z)(t,"".concat(M,"-status-").concat(o),!!o),(0,Ft.Z)(t,"".concat(M,"-status-").concat(c),rr(c)),t)),d=(0,Kt.Z)({},_);return c&&!rr(c)&&((d=d||{}).background=c),n.createElement(er,{prefixCls:a,show:!D,motionClassName:r,className:l,count:U,title:F,style:d,key:"scrollNumber"},K)})),X)};ir.Ribbon=nr;var sr=ir;const or=n.memo((e=>{let{runInfos:t}=e;const{actions:{searchRunsPayload:r},updateSearchFacets:a}=Ot(),i=pt(),[s,o]=(0,n.useState)(0),[l,c]=(0,n.useState)(0),d=(0,n.useCallback)((()=>a({},{forceRefresh:!0,preservePristine:!0})),[a]);return(0,n.useEffect)((()=>{c(0),o((()=>Date.now()))}),[t]),(0,n.useEffect)((()=>{if(!s)return;const e=setInterval((()=>{const e={experimentIds:i,filter:`attributes.start_time > ${s}`,maxResults:q.mz};r(e).then((e=>{var t;const r=(null===(t=e.runs)||void 0===t?void 0:t.length)||0;c(r)}))}),q.FK);return()=>clearInterval(e)}),[s,r,i]),(0,u.tZ)(sr,{count:l,offset:[-5,5],css:lr.pill,overflowCount:q.mz-1,children:(0,u.tZ)(m.zxk,{onClick:d,"data-testid":"runs-refresh-button",icon:(0,u.tZ)(m.bnu,{}),children:(0,u.tZ)(b.Z,{id:"ag05Pe",defaultMessage:"Refresh"})})})})),lr={pill:e=>({sup:{backgroundColor:e.colors.lime,zIndex:1}})},cr=(0,c.$j)((e=>({runInfos:e.entities.runInfosByUuid})),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.runInfosByUuid===t.entities.runInfosByUuid})(or),dr="GROUP",ur=Xe(dr,q.D5.ATTRIBUTES),pr=Xe(dr,q.D5.PARAMS),hr=Xe(dr,q.D5.METRICS),mr=Xe(dr,q.D5.TAGS),gr=[q.z.USER,q.z.SOURCE,q.z.VERSION,q.z.MODELS],vr=[q.z.EXPERIMENT_NAME,...gr],fr=(e,t)=>e.filter((e=>e.toLowerCase().includes(t.toLowerCase()))),yr=(e,t)=>{if(!t)return e;const r=e.toLowerCase().indexOf(t.toLowerCase()),n=e.substring(0,r),a=e.substring(r,r+t.length),i=e.substring(r+t.length);return r>-1?(0,u.BX)("span",{children:[n,(0,u.tZ)("strong",{children:a}),i]}):e},xr=n.memo((e=>{let{runsData:t,columnSelectorVisible:r,onChangeColumnSelectorVisible:a,updateSearchFacets:i,selectedColumns:o}=e;const l=pt(),[c,d]=(0,n.useState)(""),p=(0,n.useRef)(null),h=(0,n.useRef)(null),g=(0,n.useRef)(null),v=(0,n.useMemo)((()=>l.length>1?vr:gr),[l.length]),f=(0,n.useCallback)((e=>i((t=>{const r=e(t.selectedColumns),n=Array.from(new Set(r));return{...t,selectedColumns:n}}))),[i]),y=(0,n.useMemo)((()=>s.Z.getVisibleTagKeyList(t.tagsList)),[t]),x=(0,n.useMemo)((()=>({[q.D5.ATTRIBUTES]:v.map((e=>Xe(q.D5.ATTRIBUTES,e))),[q.D5.PARAMS]:t.paramKeyList.map((e=>Xe(q.D5.PARAMS,e))),[q.D5.METRICS]:t.metricKeyList.map((e=>Xe(q.D5.METRICS,e))),[q.D5.TAGS]:y.map((e=>Xe(q.D5.TAGS,e)))})),[t,v,y]),C=(0,n.useMemo)((()=>{const e=[],r=fr(v,c),n=fr(t.paramKeyList,c),a=fr(t.metricKeyList,c),i=fr(y,c);return r.length&&e.push({key:ur,title:"Attributes",children:r.map((e=>({key:Xe(q.D5.ATTRIBUTES,e),title:yr(e,c)})))}),a.length&&e.push({key:hr,title:`Metrics (${a.length})`,children:a.map((e=>({key:Xe(q.D5.METRICS,e),title:yr(e,c)})))}),n.length&&e.push({key:pr,title:`Parameters (${n.length})`,children:n.map((e=>({key:Xe(q.D5.PARAMS,e),title:yr(e,c)})))}),i.length&&e.push({key:mr,title:`Tags (${i.length})`,children:i.map((e=>({key:Xe(q.D5.TAGS,e),title:e})))}),e}),[v,c,t,y]),Z=(0,n.useCallback)(((e,t)=>{f(e?e=>e.filter((e=>!t.includes(e))):e=>[...e,...t])}),[f]),E=(0,n.useCallback)(((e,t)=>{f(t?t=>t.filter((t=>t!==e)):t=>[...t,e])}),[f]);(0,n.useEffect)((()=>{r&&(d(""),requestAnimationFrame((()=>{var e,t;null===h||void 0===h||null===(e=h.current)||void 0===e||e.scrollTo(0,0),null===(t=p.current)||void 0===t||t.focus({preventScroll:!0}),g.current&&g.current.scrollIntoView({block:"nearest",behavior:"smooth"})})))}),[r]);const R=(0,n.useCallback)(((e,t)=>{let{node:{key:r,checked:n}}=t;if(Ke(r.toString(),dr)){const e=We(r.toString(),dr),t=x[e];t&&Z(n,fr(t,c))}else E(r.toString(),n)}),[x,Z,E,c]),S=(0,n.useCallback)((e=>{if("ArrowDown"===e.key){const e=(null===(t=h.current)||void 0===t?void 0:t.querySelector('[role="tree"] input'))||null;e&&e.focus()}var t}),[]),k=(0,u.BX)("div",{css:br.dropdown,children:[(0,u.tZ)("div",{css:e=>({padding:e.spacing.md}),children:(0,u.tZ)(m.IIB,{value:c,prefix:(0,u.tZ)(m.W1M,{}),placeholder:"Search columns",allowClear:!0,ref:p,onChange:e=>{d(e.target.value)},onKeyDown:S})}),(0,u.tZ)("div",{ref:h,css:br.scrollableContainer,children:(0,u.tZ)(m.mpN,{"data-testid":"column-selector-tree",mode:"checkable",dangerouslySetAntdProps:{checkedKeys:o,onCheck:R},defaultExpandedKeys:[ur,pr,hr,mr],treeData:C})})]});return(0,u.tZ)(m.Ltx,{overlay:k,placement:"bottomRight",trigger:["click"],visible:r,onVisibleChange:a,children:(0,u.BX)(m.zxk,{ref:g,style:{display:"flex",alignItems:"center"},"data-testid":"column-selection-dropdown",icon:(0,u.tZ)(m.DE2,{}),children:[(0,u.tZ)(b.Z,{id:"ny+fBZ",defaultMessage:"Columns"})," ",(0,u.tZ)(m.v4q,{})]})})})),Cr=e=>{const{updateSearchFacets:t,searchFacetsState:r}=Ot();return(0,u.tZ)(xr,{...e,selectedColumns:r.selectedColumns,updateSearchFacets:t})},br={dropdown:e=>({backgroundColor:e.colors.white,width:400,border:"1px solid",borderColor:e.colors.border}),scrollableContainer:e=>({maxHeight:480,overflowY:"scroll",overflowX:"hidden",paddingBottom:e.spacing.md,"span[title]":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}})},Zr=e=>(0,n.useMemo)((()=>xt.Z.getStoreForComponent("ExperimentView",e)),[e]);const Er="seenBefore";var Rr={name:"b98nv4",styles:"position:absolute;inset:0"},Sr={name:"1ww443i",styles:"max-width:200px"},kr={name:"2qga7i",styles:"text-align:right"};const wr=e=>{let{multipleRunsSelected:t,isComparingRuns:r}=e;const a=Zr("compareRunsTooltip"),[i,s]=(0,n.useState)(t&&!a.getItem(Er));(0,n.useEffect)((()=>{const e=a.getItem(Er);s(!(!t||r||e))}),[t,r,a]);const o=(0,n.useCallback)((e=>{s(e),a.setItem(Er,!0)}),[s,a]);return(0,u.tZ)(u.HY,{children:(0,u.BX)(m.xEf.Root,{open:i,children:[(0,u.tZ)(m.xEf.Trigger,{asChild:!0,children:(0,u.tZ)("div",{css:Rr})}),(0,u.BX)(m.xEf.Content,{align:"start",children:[(0,u.BX)("div",{css:Sr,children:[(0,u.tZ)(m.ZT$.Paragraph,{children:(0,u.tZ)(b.Z,{id:"1ECve7",defaultMessage:"You can now switch to the chart view to compare runs"})}),(0,u.tZ)("div",{css:kr,children:(0,u.tZ)(m.zxk,{onClick:()=>o(!1),type:"primary",children:(0,u.tZ)(b.Z,{id:"khknxG",defaultMessage:"Got it"})})})]}),(0,u.tZ)(m.xEf.Arrow,{})]})]})})},Mr=e=>{let{isComparingRuns:t,setIsComparingRuns:r,viewState:n}=e;return(0,u.BX)(m.Xzw,{value:t?"COMPARE":"LIST",onChange:e=>{let{target:{value:t}}=e;r("COMPARE"===t)},children:[(0,u.BX)(m.HeI,{value:"LIST","data-testid":"experiment-runs-mode-switch-list",children:[(0,u.tZ)(m.eoG,{})," ",(0,u.tZ)(b.Z,{id:"Uw3UMI",defaultMessage:"Table view"})]}),(0,u.BX)(m.HeI,{value:"COMPARE","data-testid":"experiment-runs-mode-switch-compare",children:[(0,u.tZ)(m.eJP,{})," ",(0,u.tZ)(b.Z,{id:"DYvd0s",defaultMessage:"Chart view"}),(0,u.tZ)(wr,{isComparingRuns:t,multipleRunsSelected:Object.keys(n.runsSelected).length>1})]})]})};var Tr={name:"1j5vobt",styles:"display:flex;align-items:center;gap:4px"};const Br=n.memo((e=>{let{searchFacetsState:t,sortOptions:r,onSortKeyChanged:a}=e;const{orderByKey:i,orderByAsc:s}=t,o=(0,n.useMemo)((()=>`${i}${q.T_}${s?q.aU:q.iX}`),[s,i]),l=(0,n.useMemo)((()=>{const e=r.find((e=>e.value===o));let t=null===e||void 0===e?void 0:e.label;if(!t){const e=i.match(/^.+\.`(.+)`$/);e&&(t=e[1])}return(0,u.BX)("span",{css:Tr,children:[s?(0,u.tZ)(m.TV4,{}):(0,u.tZ)(m.mcG,{})," ",(0,u.tZ)(b.Z,{id:"llrWuc",defaultMessage:"Sort"}),": ",t]})}),[o,s,i,r]);return(0,u.tZ)(m.PhF,{className:"sort-select",css:Ir.sortSelectControl,value:{value:o,label:l},labelInValue:!0,virtual:!1,dangerouslySetAntdProps:{dropdownStyle:Ir.sortSelectDropdown},onChange:a,"data-test-id":"sort-select-dropdown",children:r.map((e=>(0,u.BX)(m.Wxm,{title:e.label,"data-test-id":`sort-select-${e.label}-${e.order}`,value:e.value,children:[(0,u.tZ)("span",{css:Ir.sortMenuArrowWrapper,children:e.order===q.aU?(0,u.tZ)(m.Hf3,{}):(0,u.tZ)(m.veu,{})})," ",(0,Rt.mJ)(e.label,50)]},e.value)))})})),Ir={sortSelectControl:{minWidth:140,maxWidth:360},sortSelectDropdown:{minWidth:360},sortMenuArrowWrapper:{svg:{width:12,height:12}}},Lr=()=>(0,u.BX)("div",{className:"search-input-tooltip-content",children:[(0,u.tZ)(b.Z,{id:"kIlkgf",defaultMessage:"Search runs using a simplified version of the SQL {whereBold} clause.",values:{whereBold:(0,u.tZ)("b",{children:"WHERE"})}})," ",(0,u.tZ)(b.Z,{id:"nYKZy4",defaultMessage:"<link>Learn more</link>",values:{link:e=>(0,u.tZ)("a",{href:g.Kp,target:"_blank",rel:"noopener noreferrer",children:e})}}),(0,u.tZ)("br",{}),(0,u.tZ)(b.Z,{id:"U3btBc",defaultMessage:"Examples:"}),(0,u.tZ)("br",{}),"\u2022 metrics.rmse >= 0.8",(0,u.tZ)("br",{}),"\u2022 metrics.`f1 score` < 1",(0,u.tZ)("br",{}),"\u2022 params.model = 'tree'",(0,u.tZ)("br",{}),"\u2022 attributes.run_name = 'my run'",(0,u.tZ)("br",{}),"\u2022 tags.`mlflow.user` = 'myUser'",(0,u.tZ)("br",{}),"\u2022 metric.f1_score > 0.9 AND params.model = 'tree'",(0,u.tZ)("br",{}),"\u2022 attributes.run_id IN ('a1b2c3d4', 'e5f6g7h8')",(0,u.tZ)("br",{}),"\u2022 tags.model_class LIKE 'sklearn.linear_model%'"]});const Ar=["run_id","run_name","status","artifact_uri","user_id","start_time","end_time","created"].map((e=>({value:`attributes.${e}`})));var Dr={name:"lugakg",styles:"font-weight:normal"};const Nr=(e,t)=>{const r=e.split(RegExp(t.replace(".","\\."),"ig")),n=e.match(RegExp(t.replace(".","\\."),"ig"));return(0,u.tZ)("span",{css:Dr,"data-test-id":e,children:r.map(((e,t)=>(0,u.BX)(u.HY,{children:[e,t!==r.length-1&&n&&(0,u.tZ)("b",{children:n[t]})]})))})};const Or="tooltipLastPopup";var Pr={name:"1ua1wyk",styles:"width:560px"};const Ur=e=>{const{runsData:t,searchFacetsState:r,updateSearchFacets:a,requestError:i}=e,[s,l]=(0,n.useState)(""),[c,d]=(0,n.useState)(void 0),[p,h]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1),f=(0,n.useRef)({metricNames:[],paramNames:[],tagNames:[]}),[y,x]=(0,n.useState)({Metrics:10,Parameters:10,Tags:10}),C=(0,n.useRef)([]),[b,Z]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{l(r.searchFilter)}),[r]);const E=(0,n.useMemo)((()=>{const e=f.current,r=((e,t)=>{const r=(e,t)=>[...new Set([...e,...t])],n=e=>e.flatMap((e=>Object.keys(e)));return{metricNames:r(t.metricNames,e.metricKeyList),paramNames:r(t.paramNames,e.paramKeyList),tagNames:r(n(t.tagNames),n(e.tagsList)).filter((e=>!e.startsWith("mlflow."))).map((e=>e.includes('"')||e.includes(" ")||e.includes(".")?`\`${e}\``:e.includes("`")?`"${e}"`:e))}})(t,e);return f.current=r,[{label:"Metrics",options:(n=r).metricNames.map((e=>({value:`metrics.${e}`})))},{label:"Parameters",options:n.paramNames.map((e=>({value:`params.${e}`})))},{label:"Tags",options:n.tagNames.map((e=>({value:`tags.${e}`})))},{label:"Attributes",options:Ar}];var n}),[t]);(0,n.useEffect)((()=>{const e=C.current,t=(e=>{const t=/>|<|>=|<=|=|!=|like|ilike/gi,r=(e=>{const t=/and[\s]+/gi,r=[];let n,a;for(;a=t.lastIndex,n=t.exec(e);)r.push({clause:e.substring(a,n.index),startIndex:a});return r.push({clause:e.substring(a),startIndex:a}),r})(e),n=[];return r.forEach((e=>{const r=e.clause.split(t)[0],{startIndex:a}=e;n.push({name:r,startIndex:0+a,endIndex:r.length+a})})),n})(s);if(C.current=t,g)return void v(!1);const r=t.map((e=>e.name)),n=e.map((e=>e.name));if(!(0,o.isEqual)(r,n)&&t.length>=e.length){let r=0;for(;r<t.length;){if(r>=e.length||t[r].name.trim()!==e[r].name.trim())return d(!0),void Z(t[r]);r++}}d(!1)}),[s]);const R=(0,n.useMemo)((()=>b?((e,t,r)=>e.map((e=>{const n=e.options.filter((e=>e.value.toLowerCase().includes(t.name.toLowerCase().trim()))).map((e=>({value:e.value,label:Nr(e.value,t.name.trim())}))),a=r[e.label],i=[...n.slice(0,a),...n.length>a?[{label:"...",value:`..._${e.label}`}]:[]];return{label:e.label,options:i}})).filter((e=>e.options.length>0)))(E,b,y):[]),[E,b,y]),S=(0,n.useCallback)(((e,t)=>{if(b)if(e.startsWith("...")){d(!0);const e=t.value.split("_")[1];x((t=>({...t,[e]:t[e]+10})))}else{const t=s.substring(0,b.startIndex),r=s.substring(b.endIndex);l(t+e+" "+r),v(!0),d(!1)}}),[s,l,b,d]),k=(0,n.useCallback)((()=>{a(bt)}),[a]),w=Zr(Or),[M,T]=(0,n.useState)((()=>{const e=Math.floor(Date.now()/1e3),t=w.getItem(Or);return!t||parseInt(t,10)<e-604800})),B=n.useRef(null);(0,n.useEffect)((()=>{if(i&&M){var e;const t=Math.floor(Date.now()/1e3);w.setItem(Or,t),T(!1),null===(e=B.current)||void 0===e||e.click()}}),[i]);const I=0===R.flatMap((e=>e.options)).length,L=c&&p&&!I,A=(0,n.useCallback)((e=>{"Enter"===e.key&&(L?d(!1):a({searchFilter:s})),"Escape"===e.key&&(e.preventDefault(),L&&d(!1))}),[L,s,a]);return(0,u.tZ)("div",{css:Hr.searchBox,children:(0,u.tZ)(m.QcG,{dropdownMatchSelectWidth:560,css:Pr,defaultOpen:!1,defaultActiveFirstOption:!0,open:L,options:R,onSelect:S,value:s,"data-test-id":"runs-search-autocomplete",dropdownRender:e=>(0,u.tZ)("div",{css:Hr.dropdownOverride,children:e}),children:(0,u.tZ)(m.IIB,{value:s,prefix:(0,u.tZ)(m.W1M,{css:Hr.searchBarIcon}),onKeyDown:A,onClick:()=>h(!0),onBlur:()=>h(!1),onChange:e=>l(e.target.value),placeholder:'metrics.rmse < 1 and params.model = "tree"',"data-test-id":"search-box",suffix:(0,u.BX)("div",{css:Hr.searchInputSuffix,children:[s&&(0,u.tZ)(m.zxk,{onClick:k,type:"link","data-test-id":"clear-button",children:(0,u.tZ)(m.Two,{})}),(0,u.tZ)(m.ua7,{title:(0,u.tZ)(Lr,{}),placement:"right",dangerouslySetAntdProps:{overlayInnerStyle:{width:"150%"},trigger:"click"},children:(0,u.tZ)("div",{ref:B,children:(0,u.tZ)(m.szr,{css:Hr.searchBarIcon})})})]})})})})},Hr={searchBox:e=>({display:"flex",gap:e.spacing.sm,width:560}),searchBarIcon:e=>({svg:{width:16,height:16,color:e.colors.textSecondary}}),searchInputSuffix:{display:"flex",gap:4,alignItems:"center"},dropdownOverride:{".du-bois-light-select-item-option-active:not(.du-bois-light-select-item-option-disabled)":{backgroundColor:"#e6f1f5"}}},_r=n.memo((e=>{let{searchFacetsState:t,updateSearchFacets:r,runsData:a,viewState:i,updateViewState:s,onDownloadCsv:o,sortOptions:l,requestError:c}=e;const{isComparingRuns:d}=t,p=(0,n.useCallback)((e=>{let{value:t}=e;const[n,a]=t.split(q.T_),i=je[n]||n,s=a===q.aU;r((e=>{const{selectedColumns:t}=e;return t.includes(i)||t.push(i),{...e,selectedColumns:t,orderByKey:n,orderByAsc:s}}))}),[r]),h=(0,n.useCallback)((e=>s({columnSelectorVisible:e})),[s]);return(0,u.tZ)(u.HY,{children:(0,u.BX)("div",{css:Fr.groupBar,children:[(0,u.BX)("div",{css:Fr.controlBar,children:[(0,H.cV)()&&(0,u.tZ)(Mr,{isComparingRuns:d,setIsComparingRuns:e=>r({isComparingRuns:e}),viewState:i}),(0,u.tZ)(Ur,{runsData:a,searchFacetsState:t,updateSearchFacets:r,requestError:c}),(0,u.tZ)(Br,{onSortKeyChanged:p,searchFacetsState:t,sortOptions:l}),!d&&(0,u.tZ)(Cr,{columnSelectorVisible:i.columnSelectorVisible,onChangeColumnSelectorVisible:h,runsData:a})]}),(0,u.tZ)("div",{css:Fr.groupSeparator}),(0,u.BX)("div",{css:Fr.controlBar,children:[(0,u.tZ)(m.Ltx,{trigger:["click"],placement:"bottomRight",overlay:(0,u.tZ)(m.v2r,{children:(0,u.BX)(m.v2r.Item,{className:"csv-button",onClick:o,children:[(0,u.tZ)(m._8t,{})," ",(0,u.tZ)(b.Z,{id:"rOnjGB",defaultMessage:"Download CSV"})]})}),children:(0,u.tZ)(m.zxk,{type:"tertiary",icon:(0,u.tZ)(m.VZO,{})})}),(0,u.tZ)(cr,{})]})]})})})),Fr={groupBar:{display:"grid",gridTemplateColumns:"auto 1fr auto"},controlBar:e=>({display:"flex",gap:e.spacing.sm,alignItems:"center",flexWrap:"wrap"}),groupSeparator:e=>({minWidth:e.spacing.sm}),columnSwitch:{margin:"5px"},searchBox:e=>({display:"flex",gap:e.spacing.sm,width:560}),lifecycleFilters:e=>({display:"flex",gap:8,alignItems:"center",marginTop:e.spacing.sm,marginBottom:e.spacing.sm,marginLeft:2*e.spacing.lg})},Xr=n.memo((e=>{let{runsData:t,viewState:r,updateViewState:a,updateSearchFacets:i,searchFacetsState:o,requestError:l}=e;const{paramKeyList:c,metricKeyList:d,tagsList:p}=t,h=c,m=d,g=s.Z.getVisibleTagKeyList(p),v=(0,n.useCallback)((()=>((e,t,r,n)=>{const{runInfos:a,paramsList:i,metricsList:s,tagsList:o}=e,l=Se({runInfos:a,paramKeyList:r,metricKeyList:n,tagKeyList:t,paramsList:i,metricsList:s,tagsList:o}),c=new Blob([l],{type:"application/csv;charset=utf-8"});(0,ve.saveAs)(c,"runs.csv")})(t,g,h,m)),[m,h,g,t]),f=((e,t)=>(0,n.useMemo)((()=>{let r=[];const n=[q.aU,q.iX];return r=[...Object.keys(q.Ul).reduce(((e,t)=>{const r=q.Ul[t];return n.forEach((n=>{e.push({label:r,value:q.XZ[t]+q.T_+n,order:n})})),e}),[]),...e.reduce(((e,t)=>(n.forEach((r=>{e.push({label:t,value:`${Xe(q.D5.METRICS,t)}${q.T_}${r}`,order:r})})),e)),[]),...t.reduce(((e,t)=>(n.forEach((r=>{e.push({label:t,value:`${Xe(q.D5.PARAMS,t)}${q.T_}${r}`,order:r})})),e)),[])],r}),[e,t]))(m,h);return(0,u.BX)("div",{css:Kr.wrapper,children:[(0,u.tZ)(_r,{onDownloadCsv:v,updateSearchFacets:i,searchFacetsState:o,viewState:r,updateViewState:a,sortOptions:f,runsData:t,requestError:l}),(0,u.tZ)(Ht,{runsData:t,updateSearchFacets:i,searchFacetsState:o,viewState:r})]})})),Kr={wrapper:e=>({display:"flex",gap:e.spacing.sm,flexDirection:"column",marginTop:e.spacing.md,marginBottom:e.spacing.sm})},Wr=n.lazy((()=>Promise.all([r.e(894),r.e(350)]).then(r.bind(r,59350)))),zr=e=>(0,u.tZ)(n.Suspense,{fallback:(0,u.tZ)("div",{css:e=>({display:"flex",justifyContent:"center",margin:e.spacing.md}),children:(0,u.tZ)(m.$jN,{})}),children:(0,u.tZ)(Wr,{...e})}),$r=e=>{let{isFiltered:t,onClearFilters:r}=e;return(0,u.tZ)("div",{css:Vr.noResultsWrapper,children:(0,u.tZ)("div",{css:Vr.noResults,children:t?(0,u.tZ)(m.HYy,{button:(0,u.tZ)(m.zxk,{type:"primary",onClick:r,children:(0,u.tZ)(b.Z,{id:"pEpexK",defaultMessage:"Clear filters"})}),description:(0,u.tZ)(b.Z,{id:"Nnsm0p",defaultMessage:"All runs in this experiment have been filtered. Change or clear filters to view runs."}),title:(0,u.tZ)(b.Z,{id:"Tl63jz",defaultMessage:"All runs are filtered"}),image:(0,u.tZ)(m.k1n,{})}):(0,u.tZ)(m.HYy,{description:(0,u.tZ)(b.Z,{id:"coo35p",defaultMessage:"No runs have been logged yet. <link>Learn more</link> about how to create ML model training runs in this experiment.",values:{link:e=>(0,u.tZ)("a",{target:"_blank",href:g.gM,rel:"noreferrer",children:e})}}),title:(0,u.tZ)(b.Z,{id:"sByLVU",defaultMessage:"No runs logged"}),image:(0,u.tZ)(m.uOV,{})})})})},Vr={noResults:{maxWidth:360},noResultsWrapper:e=>({marginTop:e.spacing.lg,inset:0,backgroundColor:e.colors.backgroundPrimary,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"})},jr="is-out-of-viewport",Yr="is-hidden",qr="is-minimized",Gr=".ag-root",Qr=".ag-pinned-left-cols-container",Jr=".ag-center-cols-container",en=".ag-header",tn=".ag-body-viewport",rn=e=>{let{onClick:t,gridContainerElement:r,isInitialized:a,visible:i,moreRunsAvailable:s,moreAvailableRunsTableColumnCount:o=0}=e;const l=(0,n.useRef)(null),c=(0,n.useRef)(),d=(0,n.useRef)(Boolean(s));(0,n.useEffect)((()=>{d.current=Boolean(s)}),[s]);const p=(0,n.useCallback)((e=>{if(!l.current||!window.ResizeObserver||!e)return;const t=l.current,r=e.querySelector(Gr),n=e.querySelector(Qr),a=e.querySelector(Jr),i=e.querySelector(en),s=e.querySelector(tn);let o=0,u=0,p=0,h=0,m=0,g=0;if(n&&a&&i&&r&&s){const e=new ResizeObserver((e=>{var l,v,f,y;for(const t of e)t.target===r&&(o=t.contentRect.width),t.target===n&&(u=t.contentRect.width,p=t.contentRect.height),t.target===s&&(m=t.contentRect.height),t.target===i&&(g=t.contentRect.height),t.target===a&&(h=t.contentRect.width);const x=u+h,C=g;x+180>=o?null===(l=c.current)||void 0===l||l.classList.add(jr):null===(v=c.current)||void 0===v||v.classList.remove(jr);const b=d.current?32:0,Z=p<m?p-b:m;Z<100?null===(f=c.current)||void 0===f||f.classList.add(qr):null===(y=c.current)||void 0===y||y.classList.remove(qr),t.style.transform=`translate3d(${x}px, ${C}px, 0)`,t.style.height=`${Z+1}px`}));return e.observe(n),e.observe(a),e.observe(i),e.observe(r),e.observe(s),()=>e.disconnect()}}),[]);return(0,n.useEffect)((()=>{a&&r&&(c.current=r,p(r))}),[p,a,r]),window.ResizeObserver?(0,u.tZ)("div",{ref:l,css:nn.columnContainer,className:i?"":Yr,children:i&&(0,u.tZ)("div",{css:nn.buttonContainer,children:(0,u.BX)(m.zxk,{css:nn.button,type:"link",onClick:t,children:[(0,u.tZ)(m.wl8,{css:nn.buttonIcon}),(0,u.tZ)("div",{css:nn.caption,children:(0,u.tZ)(b.Z,{id:"npHb2a",defaultMessage:"Show more columns {count, select, 0 {} other {({count} total)}}",values:{count:o}})})]})})}):null},nn={columnContainer:e=>({width:180,height:0,position:"absolute",border:`1px solid ${e.colors.grey200}`,borderTop:0,top:0,left:0,willChange:"transform",transform:"translate3d(0, 0, 0)",".is-minimized &":{display:"flex",alignItems:"center"},"&.is-hidden, .is-out-of-viewport &":{display:"none"},pointerEvents:"none",display:"flex",alignItems:"center"}),buttonContainer:e=>({top:0,paddingLeft:e.spacing.lg,paddingRight:e.spacing.lg,width:"100%",".is-minimized &":{paddingTop:e.spacing.xs},pointerEvents:"all"}),button:{whiteSpace:"pre-wrap",width:"100%"},buttonIcon:e=>({color:e.colors.textSecondary}),caption:e=>({color:e.colors.textSecondary,".is-minimized &":{display:"none"}})},an=e=>(0,u.tZ)("strong",{children:e}),sn=e=>{let{isLoading:t,allRunsCount:r}=e;return(0,u.BX)("div",{css:on.statusBar,children:[(0,u.tZ)(m.ZT$.Text,{size:"sm",color:t?"secondary":void 0,children:(0,u.tZ)(b.Z,{id:"gLj8lU",defaultMessage:"<strong>{length}</strong> matching {length, plural, =0 {runs} =1 {run} other {runs}}",values:{strong:an,length:r}})}),t&&(0,u.tZ)(m.$jN,{size:"small"})]})},on={statusBar:e=>({height:28,display:"flex",gap:8,marginTop:-1,position:"relative",alignItems:"center",borderTop:`1px solid ${e.colors.border}`})},ln=n.memo((e=>{let{experiments:t,searchFacetsState:r,runsData:a,isLoading:i,moreRunsAvailable:l,updateSearchFacets:c,updateViewState:d,onAddColumnClicked:p,rowsData:h,loadMoreRunsFunc:g}=e;const{isComparingRuns:v}=r,{paramKeyList:f,metricKeyList:y,tagsList:x}=a,[C,b]=(0,n.useState)(),[Z,E]=(0,n.useState)(),R=(0,n.useRef)([]),S=(0,n.useMemo)((()=>s.Z.getVisibleTagKeyList(x)),[x]),k=(0,n.useRef)(null),w=(0,n.useMemo)((()=>h.some((e=>{var t;return null===(t=e.runDateAndNestInfo)||void 0===t?void 0:t.hasExpander}))),[h]),M=(0,n.useCallback)((e=>{let{api:t}=e;const r=t.getSelectedRows().filter((e=>!e.isLoadMoreRow)).map((e=>{let{runInfo:t}=e;return t.run_uuid}));d({runsSelected:r.reduce(((e,t)=>({...e,[t]:!0})),{})}),R.current=r}),[d]),T=(0,n.useCallback)((e=>{const t=e.api.getSelectedRows().filter((e=>!e.isLoadMoreRow));if(R.current&&t.length!==R.current.length){const t=Boolean(e.node.isSelected()),{runDateAndNestInfo:r}=e.data;if(!r)return;const{isParent:n,expanderOpen:a,childrenIds:i}=r;if(n&&a&&i){const r=i;e.api.forEachNode((e=>{var n;if(null!==(n=e.data)&&void 0!==n&&n.isLoadMoreRow)return;const{runInfo:a,runDateAndNestInfo:i}=e.data,s=a.run_uuid;r.includes(s)&&(null!==i&&void 0!==i&&i.childrenIds&&r.push(...i.childrenIds),e.setSelected(t,!1,!0))}))}}}),[]),B=(0,n.useCallback)(((e,t)=>{c({orderByKey:e,orderByAsc:t})}),[c]),I=(0,n.useCallback)((e=>c((t=>{let{runsExpanded:r,...n}=t;return{...n,runsExpanded:{...r,[e]:!r[e]}}}))),[c]),L=(0,n.useCallback)((e=>{c((t=>({...t,runsPinned:t.runsPinned.includes(e)?t.runsPinned.filter((t=>t!==e)):[...t.runsPinned,e]}))),requestAnimationFrame((()=>{if(!C)return;const t=C.getRowNode(e);t&&C.redrawRows({rowNodes:[t]})}))}),[C,c]),A=(0,n.useCallback)((e=>{c((t=>{if(e===Be.SHOWALL)return{...t,runsHidden:[]};if(e===Be.HIDEALL)return{...t,runsHidden:h.map((e=>e.runUuid))};const r=e;return{...t,runsHidden:t.runsHidden.includes(r)?t.runsHidden.filter((e=>e!==r)):[...t.runsHidden,r]}}))}),[c,h]),D=(0,n.useCallback)((e=>{b(e.api),E(e.columnApi)}),[]),N=Je({searchFacetsState:r,onSortBy:B,onExpand:I,compareExperiments:t.length>1,onTogglePin:L,onToggleVisibility:A,metricKeyList:y,paramKeyList:f,tagKeyList:S,columnApi:Z,isComparingRuns:v});(0,n.useEffect)((()=>{if(C)if(i)C.showLoadingOverlay();else{if(C.hideOverlay(),h.length&&l)return void C.setRowData([...h,{runUuid:(0,o.uniqueId)("load_more"),isLoadMoreRow:!0}]);C.setRowData(h)}}),[C,h,i,l,g]);const O=(0,n.useMemo)((()=>(t.length>1?Qe.length:Ge.length)+(y.length+f.length+S.length)),[t.length,S.length,y.length,f.length]),P=r.selectedColumns.length>=O,U=Math.max(0,O-r.selectedColumns.length),H=!P&&!v&&h.length>0,_=(0,n.useMemo)((()=>a.runInfos.filter((e=>r.runsPinned.includes(e.run_uuid)||a.runUuidsMatchingFilter.includes(e.run_uuid))).length),[a,r.runsPinned]);return(0,n.useLayoutEffect)((()=>{C&&v&&(C.deselectAll(),C.sizeColumnsToFit())}),[C,v]),(0,u.BX)("div",{css:cn.tableAreaWrapper,children:[(0,u.BX)("div",{ref:k,className:$t()("ag-theme-balham ag-grid-sticky",{"ag-grid-expanders-visible":w}),css:cn.agGridOverrides,children:[(0,u.tZ)(zr,{defaultColDef:et,columnDefs:N,rowSelection:"multiple",onGridReady:D,onSelectionChanged:M,rowHeight:32,headerHeight:32,onRowSelected:T,suppressRowClickSelection:!0,suppressColumnMoveAnimation:!0,suppressScrollOnNewData:!0,isFullWidthRow:qe,fullWidthCellRenderer:"LoadMoreRowRenderer",fullWidthCellRendererParams:{loadMoreRunsFunc:g},suppressFieldDotNotation:!0,enableCellTextSelection:!0,components:{agColumnHeader:G,loadingOverlayComponent:m.$jN,LoadMoreRowRenderer:_e,SourceCellRenderer:me,ModelsCellRenderer:pe,VersionCellRenderer:ge,DateCellRenderer:re,ExperimentNameCellRenderer:se,RowActionsCellRenderer:Ae,RowActionsHeaderCellRenderer:Ne,RunNameCellRenderer:Pe},suppressNoRowsOverlay:!0,loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:{showImmediately:!0},getRowId:Ye,rowBuffer:101}),H&&(0,u.tZ)(rn,{gridContainerElement:k.current,isInitialized:Boolean(C),onClick:p,visible:!i,moreRunsAvailable:l,moreAvailableRunsTableColumnCount:U})]}),h.length<1&&!i&&(0,u.tZ)($r,{onClearFilters:()=>c(bt),isFiltered:Zt(r)}),(0,u.tZ)(sn,{allRunsCount:_,isLoading:i})]})})),cn={tableAreaWrapper:{display:"flex",flexDirection:"column"},agGridOverrides:e=>{const t=(e=>({rowBackground:e.colors.backgroundPrimary,rowBackgroundHover:`${e.colors.grey600}0A`,rowBackgroundSelected:`${e.colors.grey600}14`,rowBackgroundHoverSelected:`${e.colors.grey600}1F`,columnSortedBy:`${e.colors.blue100}b3`,headerBackground:e.colors.grey100,headerTextColor:"#2E3840",headerGroupTextColor:e.colors.textSecondary,borderColor:e.colors.grey200,headerBorderColor:"transparent",checkboxBorderColor:e.colors.actionDefaultBorderDefault,checkboxBorderColorChecked:e.colors.backgroundPrimary,checkboxBackgroundColorChecked:e.colors.actionPrimaryBackgroundDefault}))(e);return{height:"100%",position:"relative","&.ag-theme-balham":{"--ag-border-color":t.borderColor,"--ag-row-border-color":t.borderColor,"--ag-odd-row-background-color":t.rowBackground,"--ag-row-hover-color":t.rowBackgroundHover,"--ag-selected-row-background-color":t.rowBackgroundSelected,"--ag-header-foreground-color":t.headerTextColor,"--ag-header-background-color":t.headerBackground,"&.ag-grid-sticky .ag-header":{position:"sticky",top:0,zIndex:1},"&.ag-grid-sticky .ag-root":{overflow:"visible"},"&.ag-grid-sticky .ag-root-wrapper":{border:"0",borderRadius:"4px",overflow:"visible"},".ag-header::after":{content:'""',position:"absolute",top:32,left:0,right:0,height:1,backgroundColor:t.borderColor},".ag-cell":{lineHeight:"min(var(--ag-line-height, 30px), 30px)"},".ag-header-cell":{padding:0},".ag-header-cell .ag-checkbox":{padding:"0 7px",borderLeft:"1px solid transparent"},".ag-cell.is-ordered-by, .ag-header-cell > .is-ordered-by":{backgroundColor:t.columnSortedBy},".ag-header-row":{"--ag-border-color":t.headerBorderColor},".ag-header-row.ag-header-row-column-group":{"--ag-header-foreground-color":t.headerGroupTextColor},".ag-row.ag-row-selected.ag-row-hover":{backgroundColor:t.rowBackgroundHoverSelected},".ag-header:not(:hover) .ag-header-cell::after, .ag-header:not(:hover) .ag-header-group-cell::after":{opacity:0},".ag-pinned-left-header":{borderRight:"none"},".ag-overlay-loading-wrapper":{paddingTop:4*e.spacing.md,alignItems:"center",zIndex:2},".ag-overlay-loading-wrapper .ag-react-container":{flex:1},".ag-center-cols-container":{minHeight:0},".ag-full-width-row":{borderBottom:0,backgroundColor:"transparent",zIndex:1,"&.ag-row-hover":{backgroundColor:"transparent"}},".is-checkbox-cell":{display:"flex",alignItems:"center",paddingLeft:7},".ag-header-cell .ag-checkbox .ag-input-wrapper:not(.ag-indeterminate):not(.ag-checked)":{"--ag-checkbox-background-color":t.headerBackground},".ag-cell-wrapper .ag-selection-checkbox":{marginRight:20},".is-checkbox-cell, .ag-header-cell .ag-checkbox":{".ag-checkbox-input-wrapper::after":{color:t.checkboxBorderColor},".ag-checkbox-input-wrapper.ag-checked":{"--ag-checkbox-background-color":t.checkboxBackgroundColorChecked,"--ag-checkbox-checked-color":t.checkboxBorderColorChecked,"&::after":{color:t.checkboxBorderColorChecked}}}}}}};var dn=r(59602);class un{constructor(){this.runsSelected={},this.hiddenChildRunsSelected={},this.columnSelectorVisible=!1}}const pn=e=>e.map(((e,t)=>{var r;let{runInfo:n,metrics:a=[],params:i=[],tags:s={}}=e;return{index:t,runInfo:n,level:0,isPinnable:!(null!==(r=s["mlflow.parentRunId"])&&void 0!==r&&r.value),metrics:a,params:i,tags:s}})),hn=(e,t,r)=>{if(!e)return[];const n={};for(const a of t)n[`${r}-${a}`]="-";for(const{key:a,value:i}of e)(i||(0,o.isNumber)(i))&&(n[`${r}-${a}`]=i);return n},mn=e=>{const t=["#077A9D","#8BCAE7","#FFAB00","#FFDB96","#00A972","#99DDB4","#BA7B23","#FF3621","#FCA4A1","#919191","#00875C","#1B5162","#914B9F","#D01F0B","#BD89C7","#AB4057","#5F5F5F","#BF7080","#C2C2C2","#7F1035"];let r=0,n=0;for(let a=0;a<e.length;a++)r=(r+e.charCodeAt(a))%255,n=(n+r)%255;return t[(r|n<<8)%t.length]},gn=e=>{let{experiments:t,modelVersionsByRunUuid:r,runsExpanded:n,nestChildren:a,referenceTime:i,paramKeyList:o,metricKeyList:l,tagKeyList:c,runsPinned:d,runsHidden:u,runData:p,runUuidsMatchingFilter:h}=e;const m=s.Z.getExperimentNameMap(s.Z.sortExperimentsById(t)),g=a?(e=>{let{runsExpanded:t,runData:r}=e;const n={};r.forEach(((e,t)=>{let{runInfo:r}=e;n[r.run_uuid]=t}));const a=r.map((e=>{let{runInfo:t}=e;return{value:t.run_uuid}}));let i=!1;if(r.forEach(((e,t)=>{let{tags:r}=e;const s=null===r||void 0===r?void 0:r["mlflow.parentRunId"];if(s){const e=n[s.value];void 0!==e&&(i=!0,a[t].parent=a[e])}})),!i)return pn(r);const s={},o=[];a.forEach(((e,t)=>{const{parent:r}=e;void 0!==r&&r.value!==e.value?s[r.value]?s[r.value].push(t):s[r.value]=[t]:o.push(t)}));const l=[],c=new Set,d=(e,n)=>{if(!c.has(e)){const a=r[e].runInfo,i=a.run_uuid,u=Boolean(o.includes(e))||0===n,p={index:e,isParent:!1,hasExpander:!1,level:n,runInfo:a,params:r[e].params||[],metrics:r[e].metrics||[],tags:r[e].tags||{},isPinnable:u};s[i]&&(p.isParent=!0,p.hasExpander=!0,p.expanderOpen=Boolean(t[i]),p.childrenIds=s[i].map((e=>r[e].runInfo.run_uuid))),l.push(p),c.add(e);const h=s[i];h&&t[i]&&h.forEach((e=>{d(e,n+1)}))}};return o.forEach((e=>{d(e,0)})),l})({runData:p,runsExpanded:n}):pn(p),v=[],f=g.map((e=>{const{runInfo:t,isParent:n=!1,hasExpander:a=!1,level:p=0,expanderOpen:h=!1,isPinnable:g=!1,childrenIds:f=[],tags:y,params:x,metrics:C}=e,b=(C||[]).map((e=>{let{key:t,value:r}=e;return{key:t,value:s.Z.formatMetric(r)}})),Z=t.run_uuid,{experiment_id:E}=t,R=m[E],S=s.Z.getUser(t,y),k=s.Z.getDuration(t.start_time,t.end_time),w=s.Z.getRunName(t)||t.run_uuid,M=s.Z.getVisibleTagValues(y).map((e=>{let[t,r]=e;return{key:t,value:r}})),T={startTime:t.start_time,referenceTime:i,experimentId:E,runUuid:Z,runStatus:t.status,isParent:n,hasExpander:a,expanderOpen:h,childrenIds:f,level:p},B={registeredModels:r[t.run_uuid]||[],loggedModels:s.Z.getLoggedModelsFromTags(y),experimentId:t.experiment_id,runUuid:t.run_uuid},I={version:s.Z.getSourceVersion(y),name:s.Z.getSourceName(y),type:s.Z.getSourceType(y)},L=u.includes(Z),A=g&&d.includes(Z),D=v.includes(Z);return(A||D)&&v.push(...f),{runUuid:Z,runDateAndNestInfo:T,runInfo:t,experimentName:R,experimentId:E,duration:k,user:S,runName:w,tags:y,models:B,version:I,pinnable:g,color:mn(Z),hidden:L,pinned:A||D,...hn(x,o,ke),...hn(b,l,we),...hn(M,c,Me)}}));return[...f.filter((e=>{let{pinned:t}=e;return t})),...f.filter((e=>{let{pinned:t,runUuid:r}=e;return!t&&h.includes(r)}))]};var vn=r(84535);let fn=function(e){return e.BAR="BAR",e.LINE="LINE",e.SCATTER="SCATTER",e.CONTOUR="CONTOUR",e.PARALLEL="PARALLEL",e}({});class yn{constructor(e){this.uuid=void 0,this.type=fn.BAR,this.runsCountToCompare=10,this.uuid=e}static serialize(e){return Object.keys(e).reduce(((t,r)=>({...t,[r]:e[r]})),{})}static getEmptyChartCardByType(e,t){return e===fn.BAR?new bn(t):e===fn.SCATTER?new xn(t):e===fn.PARALLEL?new En(t):e===fn.LINE?new Cn(t):new Zn(t)}static getBaseChartConfigs(e){const t=[yn.getEmptyChartCardByType(fn.PARALLEL,(0,vn.Fs)())];return e&&t.push({...yn.getEmptyChartCardByType(fn.BAR,(0,vn.Fs)()),metricKey:e}),t}}class xn extends yn{constructor(){super(...arguments),this.type=fn.SCATTER,this.xaxis={key:"",type:"METRIC"},this.yaxis={key:"",type:"METRIC"},this.runsCountToCompare=100}}class Cn extends yn{constructor(){super(...arguments),this.type=fn.LINE,this.metricKey="",this.scaleType="linear",this.xAxisKey="step"}}class bn extends yn{constructor(){super(...arguments),this.type=fn.BAR,this.metricKey=""}}class Zn extends yn{constructor(){super(...arguments),this.type=fn.CONTOUR,this.xaxis={key:"",type:"METRIC"},this.yaxis={key:"",type:"METRIC"},this.zaxis={key:"",type:"METRIC"}}}class En extends yn{constructor(){super(...arguments),this.type=fn.PARALLEL,this.selectedParams=[],this.selectedMetrics=[]}}var Rn,Sn,kn,wn,Mn;function Tn(){return Tn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tn.apply(this,arguments)}function Bn(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",Tn({width:18,height:16,viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,Rn||(Rn=n.createElement("path",{d:"M1 0.813599V15.1865H17",stroke:"#A3AEB8",strokeLinecap:"round"})),Sn||(Sn=n.createElement("rect",{x:3.16943,y:10.5763,width:2.16949,height:3.25424,fill:"#338ECC"})),kn||(kn=n.createElement("rect",{x:6.42371,y:5.15259,width:2.16949,height:8.67797,fill:"#338ECC"})),wn||(wn=n.createElement("rect",{x:9.67798,y:8.40686,width:2.16949,height:5.42373,fill:"#338ECC"})),Mn||(Mn=n.createElement("rect",{x:12.9323,y:1.89832,width:2.16949,height:11.9322,fill:"#338ECC"})))}const In=n.forwardRef(Bn);var Ln,An,Dn;r.p;function Nn(){return Nn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nn.apply(this,arguments)}function On(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",Nn({width:18,height:18,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,Ln||(Ln=n.createElement("path",{d:"M1 1V17H17",stroke:"#A3AEB8",strokeLinecap:"round"})),An||(An=n.createElement("path",{d:"M12.9749 4.94148C12.9188 4.71702 12.221 4.73284 12.0618 4.71515C11.1779 4.61693 10.2817 4.66052 9.39271 4.66052C8.11919 4.66052 7.15648 4.97961 6.24753 5.90922C5.86197 6.30355 5.5235 6.77684 5.23295 7.24378C4.99434 7.62726 4.65544 7.93479 4.40569 8.31299C3.93777 9.02154 3.56281 9.80723 3.56281 10.6699C3.56281 11.1806 3.37479 11.598 3.76962 12.0669C4.19449 12.5714 4.6863 12.9507 5.27978 13.2649C5.88594 13.5858 6.42202 13.8619 7.13723 13.8619C7.74338 13.8619 8.34952 13.8619 8.95567 13.8619C9.45735 13.8619 9.96042 13.8731 10.4619 13.8619C11.1412 13.8468 11.9484 13.1895 12.413 12.7381C13.581 11.6035 14.2393 9.88016 14.2393 8.24665C14.2393 7.69923 14.3797 7.17063 14.3797 6.62723C14.3797 6.40084 14.4779 5.87696 14.2744 5.71411C13.9268 5.43606 13.5785 5.13789 13.1857 4.94148",stroke:"#338ECC",strokeLinecap:"round"})),Dn||(Dn=n.createElement("path",{d:"M11.9213 6.83789C11.2761 6.83789 10.6309 6.83789 9.98577 6.83789C9.19776 6.83789 8.80182 7.44144 8.2844 7.97734C7.58163 8.70521 7.28544 9.67306 7.28544 10.666C7.28544 10.9641 7.22004 11.177 7.46104 11.3645C7.6831 11.5372 8.10719 11.6142 8.37806 11.6142C9.07316 11.6142 9.91042 11.5583 10.4462 11.0523C10.9277 10.5975 11.473 10.3701 11.8159 9.75284C12.045 9.34042 12.2022 8.86324 12.2022 8.38317C12.2022 8.14903 12.2022 7.9149 12.2022 7.68077C12.2022 7.4241 12.0208 7.38817 11.9213 7.18909",stroke:"#338ECC",strokeLinecap:"round"})))}const Pn=n.forwardRef(On);var Un,Hn;r.p;function _n(){return _n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_n.apply(this,arguments)}function Fn(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",_n({width:22,height:22,viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,Un||(Un=n.createElement("path",{d:"M4.38977 15.717L8.79655 10.8113L12.5254 14.9622L19.644 7.03772",stroke:"#338ECC",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),Hn||(Hn=n.createElement("path",{d:"M1 1V21H21",stroke:"#A3AEB8",strokeLinecap:"round"})))}const Xn=n.forwardRef(Fn);var Kn,Wn,zn,$n,Vn;r.p;function jn(){return jn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jn.apply(this,arguments)}function Yn(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",jn({width:18,height:18,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,Kn||(Kn=n.createElement("path",{d:"M1 1V17H17",stroke:"#A3AEB8",strokeLinecap:"round"})),Wn||(Wn=n.createElement("path",{d:"M4.21875 3.58289C4.55663 3.58289 4.88067 3.68935 5.21469 3.73008C5.6474 3.78285 6.02137 3.96513 6.37191 4.21552C6.76902 4.49917 7.0271 4.74589 7.24101 5.18954C7.44337 5.60925 7.59378 6.06989 7.72958 6.51432C7.86002 6.94121 8.09708 7.33726 8.19153 7.77803C8.25347 8.0671 8.34514 8.32427 8.44678 8.60015C8.58028 8.96252 8.80086 9.27915 8.96667 9.62583C9.15145 10.0122 9.216 10.4461 9.34876 10.8551C9.57831 11.5623 9.91132 12.4763 10.7205 12.6731C11.4284 12.8453 12.1459 12.8845 12.8705 12.8845C13.0981 12.8845 13.3979 12.898 13.5831 12.7499C13.6402 12.7042 13.7451 12.6907 13.8164 12.6591C13.8752 12.6329 14.0919 12.5871 14.1123 12.5463",stroke:"#CCE3F2",strokeLinecap:"round"})),zn||(zn=n.createElement("path",{d:"M4.16162 12.9805C4.32512 12.9805 4.4895 12.9859 4.65284 12.9805C4.84076 12.9742 5.0468 12.7952 5.2099 12.707C5.62236 12.4841 5.99426 12.0648 6.24299 11.6739C6.49491 11.2781 6.8776 10.9871 7.0887 10.5649C7.27767 10.187 7.50992 9.80749 7.73691 9.45078C7.93911 9.13304 8.10211 8.77722 8.28637 8.44554C8.43088 8.18544 8.45 7.88672 8.60542 7.62768C8.94898 7.05509 9.16215 6.418 9.45873 5.82484C9.72614 5.29001 9.96898 4.82426 10.4159 4.42207C10.5753 4.27853 10.8984 4.21824 11.0995 4.14861C11.3303 4.06873 11.579 4.02714 11.8136 3.93592C12.0394 3.84807 12.2521 3.84383 12.4795 3.77386C12.6993 3.70623 12.9319 3.63713 13.1632 3.63713C13.5192 3.63713 13.9089 3.59155 14.2798 3.59155",stroke:"#CCE3F2",strokeLinecap:"round"})),$n||($n=n.createElement("path",{d:"M3.79248 2.74207V13.8225",stroke:"#338ECC",strokeLinecap:"round"})),Vn||(Vn=n.createElement("path",{d:"M14.873 3.04419V13.7217",stroke:"#338ECC",strokeLinecap:"round"})))}const qn=n.forwardRef(Yn);var Gn,Qn,Jn,ea,ta,ra,na;r.p;function aa(){return aa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aa.apply(this,arguments)}function ia(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",aa({width:18,height:16,viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,Gn||(Gn=n.createElement("path",{d:"M1 0.813599V15.1865H17",stroke:"#A3AEB8",strokeLinecap:"round"})),Qn||(Qn=n.createElement("circle",{cx:3.98301,cy:12.4746,r:1.35593,fill:"#338ECC"})),Jn||(Jn=n.createElement("ellipse",{cx:9.40684,cy:10.8475,rx:1.35593,ry:1.35593,fill:"#338ECC"})),ea||(ea=n.createElement("circle",{cx:5.6102,cy:8.1356,r:1.35593,fill:"#338ECC",fillOpacity:.25})),ta||(ta=n.createElement("circle",{cx:9.40684,cy:6.50852,r:1.35593,fill:"#338ECC"})),ra||(ra=n.createElement("ellipse",{cx:13.7457,cy:5.96616,rx:1.35593,ry:1.35593,fill:"#338ECC",fillOpacity:.25})),na||(na=n.createElement("ellipse",{cx:16.4576,cy:2.46128,rx:1.35593,ry:1.35593,fill:"#338ECC"})))}const sa=n.forwardRef(ia);r.p;const oa=e=>{let{onAddChart:t}=e;return(0,u.BX)(m.h_2.Root,{modal:!1,children:[(0,u.tZ)(m.h_2.Trigger,{asChild:!0,children:(0,u.tZ)(m.zxk,{css:la.addChartButton,icon:(0,u.tZ)(m.pOD,{}),"data-testid":"experiment-view-compare-runs-add-chart",children:"Add chart"})}),(0,u.BX)(m.h_2.Content,{align:"end",children:[(0,u.BX)(m.h_2.Item,{onClick:()=>t(fn.BAR),"data-testid":"experiment-view-compare-runs-chart-type-bar",children:[(0,u.tZ)(m.h_2.IconWrapper,{css:la.iconWrapper,children:(0,u.tZ)(In,{})}),"Bar chart"]}),(0,u.BX)(m.h_2.Item,{onClick:()=>t(fn.LINE),"data-testid":"experiment-view-compare-runs-chart-type-line",children:[(0,u.tZ)(m.h_2.IconWrapper,{css:la.iconWrapper,children:(0,u.tZ)(Xn,{})}),"Line chart"]}),(0,u.BX)(m.h_2.Item,{onClick:()=>t(fn.PARALLEL),"data-testid":"experiment-view-compare-runs-chart-type-parallel",children:[(0,u.tZ)(m.h_2.IconWrapper,{css:la.iconWrapper,children:(0,u.tZ)(qn,{})}),"Parallel coordinates"]}),(0,u.BX)(m.h_2.Item,{onClick:()=>t(fn.SCATTER),"data-testid":"experiment-view-compare-runs-chart-type-scatter",children:[(0,u.tZ)(m.h_2.IconWrapper,{css:la.iconWrapper,children:(0,u.tZ)(sa,{})}),"Scatter chart"]}),(0,u.BX)(m.h_2.Item,{onClick:()=>t(fn.CONTOUR),"data-testid":"experiment-view-compare-runs-chart-type-contour",children:[(0,u.tZ)(m.h_2.IconWrapper,{css:la.iconWrapper,children:(0,u.tZ)(Pn,{})}),"Contour chart"]})]})]})},la={addChartButton:e=>({backgroundColor:`${e.colors.backgroundPrimary} !important`}),iconWrapper:e=>({width:e.general.iconSize+e.spacing.xs})};var ca=r(25763);const da=e=>{const t=(0,n.useRef)(e);return(0,n.useEffect)((()=>{t.current=e}),[e]),e=>{t.current(e)}},ua=(e,t)=>(r,n,a)=>{var i,s;const o=-1===n&&-1===a;var l,c,d,u;(null===(i=r.querySelector(".is-hover-highlight"))||void 0===i||i.classList.remove("is-hover-highlight"),n>-1)&&(null===(l=r.querySelectorAll(e)[n])||void 0===l||l.classList.add("is-hover-highlight"));(null===(s=r.querySelector(".is-selection-highlight"))||void 0===s||s.classList.remove("is-selection-highlight"),a>-1)&&(null===(c=r.querySelectorAll(e)[a])||void 0===c||c.classList.add("is-selection-highlight"));o?null===(d=r.querySelector(t))||void 0===d||d.classList.remove("is-highlight"):null===(u=r.querySelector(t))||void 0===u||u.classList.add("is-highlight")},pa=ua("svg .trace.bars g.point",".trace.bars"),ha=ua("svg .scatterlayer g.trace",".scatterlayer"),ma=ua("svg .scatterlayer path.point",".trace.scatter"),ga=(e,t,r,a)=>{const i=(0,n.useMemo)((()=>e?r.findIndex((e=>e.runInfo.run_uuid===t)):-1),[r,e,t]),[s,o]=(0,n.useState)(-1);return(0,n.useEffect)((()=>{e&&a(e,s,i)}),[a,e,i,s]),{selectedTraceIndex:i,hoveredPointIndex:s,setHoveredPointIndex:o}};var va=r(6233);const fa={displaylogo:!1,scrollZoom:!0,doubleClick:"autosize",showTips:!1},ya=n.memo((e=>{let{runsData:t,metricKey:r,className:i,margin:s=va.MP,onUpdate:o,onHover:l,onUnhover:c,barWidth:d=.5,width:p,height:h,displayRunNames:m=!0,useDefaultHoverBox:g=!0,displayMetricKey:v=!0,selectedRunUuid:f}=e;const y=(0,n.useMemo)((()=>{const e=t.map((e=>e.runInfo.run_uuid)),n=t.map((e=>{var t;return(0,va.To)(null===(t=e.metrics[r])||void 0===t?void 0:t.value)})),a=t.map((e=>{var t;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"===typeof e?e.toFixed(t):e}(null===(t=e.metrics[r])||void 0===t?void 0:t.value)})),i=t.map((e=>e.color)),s=n.some((e=>e&&e<0));return[{y:e,x:n,text:a,textposition:s?"auto":"outside",textfont:{size:11},type:"bar",hovertemplate:g?"%{label}<extra></extra>":void 0,hoverinfo:g?"y":"none",hoverlabel:g?va.Lg:void 0,width:d,orientation:"h",marker:{color:i}}]}),[t,r,d,g]),{layoutHeight:x,layoutWidth:C,setContainerDiv:b,containerDiv:Z,isDynamicSizeSupported:E}=(0,va.Ih)(),{formatMessage:R}=(0,a.Z)(),[S,k]=(0,n.useState)({width:p||C,height:h||x,margin:s,xaxis:{title:v?r:void 0},yaxis:{showticklabels:m,title:m?R({id:"+hQ+de",defaultMessage:"Run name"}):void 0,tickfont:{size:11},fixedrange:!0}});(0,n.useEffect)((()=>{k((e=>({...e,width:p||C,height:h||x,margin:s,xaxis:{...e.xaxis,title:v?r:void 0}})))}),[C,x,s,r,p,h,v]);const{setHoveredPointIndex:w}=ga(Z,f,t,pa),M=(0,n.useCallback)((e=>{var t,r,n;let{points:a,event:i}=e;w(null!==(t=null===(r=a[0])||void 0===r?void 0:r.pointIndex)&&void 0!==t?t:-1);const s=null===(n=a[0])||void 0===n?void 0:n.label;s&&(null===l||void 0===l||l(s,i))}),[l,w]),T=(0,n.useCallback)((()=>{null===c||void 0===c||c(),w(-1)}),[c,w]),B=da(M);return(0,u.tZ)("div",{css:[va.QW.chartWrapper,xa.highlightStyles,""],className:i,ref:b,children:(0,u.tZ)(ca.L,{data:y,useResizeHandler:!E,css:va.QW.chart,onUpdate:o,layout:S,config:fa,onHover:B,onUnhover:T})})})),xa={highlightStyles:{".trace.bars g.point path":{transition:"var(--trace-transition)"},".trace.bars.is-highlight g.point path":{opacity:"var(--trace-opacity-dimmed-high) !important"},".trace.bars g.point.is-hover-highlight path":{opacity:"var(--trace-opacity-highlighted) !important"},".trace.bars g.point.is-selection-highlight path":{opacity:"var(--trace-opacity-highlighted) !important",stroke:"var(--trace-stroke-color)",strokeWidth:"var(--trace-stroke-width) !important"}}},Ca=n.createContext(null);let ba=function(e){return e[e.HIDDEN=0]="HIDDEN",e[e.HOVER=1]="HOVER",e[e.VISIBLE=2]="VISIBLE",e}({});const Za=e=>{if(null===e||!(e instanceof Element))return null;if(e instanceof HTMLElement)return e;let t=e;for(;t&&!(t instanceof HTMLElement);)t=t.parentElement;return t},Ea=e=>{let{className:t,children:r,contextData:a,component:i,hoverOnly:s=!1}=e;const o=(0,n.useRef)(null),l=(0,n.useRef)(null),c=(0,n.useRef)({x:0,y:0}),[d,p]=(0,n.useState)(ba.HIDDEN),[h,m]=(0,n.useState)(null),[g,v]=(0,n.useState)(""),[f,y]=(0,n.useState)(null),x=(0,n.useRef)(null),C=(0,n.useRef)(d),b=(0,n.useRef)(g),Z=(0,n.useRef)(h),E=(0,n.useCallback)((()=>{if(!l.current||!o.current)return;let e=c.current.x,t=c.current.y;const r=l.current.getBoundingClientRect(),n=o.current.getBoundingClientRect();c.current.x+r.width>=n.width&&(e-=r.width),c.current.y+r.height>=n.height&&(t-=r.height),l.current.style.left="0px",l.current.style.top="0px",l.current.style.transform=`translate3d(${e+1}px, ${t+1}px, 0)`}),[]);(0,n.useEffect)((()=>{C.current=d}),[d]);const R=(0,n.useCallback)(((e,t)=>{var r;const n=e.getBoundingClientRect(),a=(null===(r=o.current)||void 0===r?void 0:r.getBoundingClientRect())||{left:0,top:0};return{x:t.offsetX+(n.left-a.left),y:t.offsetY+(n.top-a.top)}}),[]),S=(0,n.useCallback)((e=>{if(C.current===ba.HOVER&&l.current&&o.current){x.current=null;const t=Za(e.target);t&&(c.current=R(t,e.nativeEvent),E())}}),[E,R]),k=(0,n.useCallback)(((e,t,r,n)=>{var a;b.current=e,Z.current=t,C.current!==ba.VISIBLE&&(m(t),!e&&null!==(a=x.current)&&void 0!==a&&a.runUuid||v((t=>(n&&y(n),C.current===ba.HIDDEN||C.current===ba.HOVER&&e!==t?(p(ba.HOVER),e):t))))}),[]),w=(0,n.useCallback)((e=>{s||0===e.button&&b.current&&(x.current={x:e.nativeEvent.pageX,y:e.nativeEvent.pageY,runUuid:b.current})}),[s]),M=(0,n.useCallback)((e=>{var t;if(null!==(t=x.current)&&void 0!==t&&t.runUuid&&e.nativeEvent.pageX===x.current.x&&e.nativeEvent.pageY===x.current.y){if(C.current===ba.VISIBLE){v(x.current.runUuid);const t=Za(e.nativeEvent.target);t&&(c.current=R(t,e.nativeEvent),E())}else p(ba.VISIBLE);e.stopPropagation()}x.current=null}),[E,R]),T=(0,n.useCallback)((()=>p(ba.HIDDEN)),[]);(0,n.useLayoutEffect)((()=>{if(!o.current)return;const e=o.current.getRootNode(),t=e=>{var t;if(C.current!==ba.VISIBLE)return;const r=Za(e.target);if(!r)return;r instanceof HTMLElement&&(null===l||void 0===l?void 0:l.current)instanceof HTMLElement&&l.current.contains(r)||null!==(t=x.current)&&void 0!==t&&t.runUuid||p(ba.HIDDEN)};return e.addEventListener("click",t,{capture:!0}),()=>{e.removeEventListener("click",t,{capture:!0})}}),[R,E]);const B=(0,n.useCallback)((()=>{var e;b.current="",null!==(e=x.current)&&void 0!==e&&e.runUuid||C.current===ba.VISIBLE||(v(""),p(ba.HIDDEN))}),[]),I=(0,n.useMemo)((()=>d!==ba.VISIBLE?null:g),[d,g]),L=(0,n.useMemo)((()=>({updateTooltip:k,resetTooltip:B,selectedRunUuid:I,closeContextMenu:T})),[k,B,I,T]);return(0,u.BX)(Ca.Provider,{value:L,children:[(0,u.tZ)("div",{onMouseMove:S,onMouseDownCapture:w,onClickCapture:M,children:r}),(0,u.tZ)("div",{css:Sa.contextMenuContainer,className:t,ref:o,children:d!==ba.HIDDEN&&g&&(0,u.tZ)("div",{ref:l,css:Sa.contextMenuWrapper,"data-testid":"tooltip-container",style:{userSelect:d===ba.HOVER?"none":"unset",pointerEvents:d===ba.HOVER?"none":"all"},children:(0,u.tZ)(i,{runUuid:g,additionalAxisData:f,hoverData:h,contextData:a,isHovering:d===ba.HOVER,closeContextMenu:T})})})]})},Ra=e=>{const t=(0,n.useContext)(Ca);if(!t)throw new Error("You must invoke useCompareRunsTooltip() in a component being ancestor of <CompareRunsTooltipWrapper />!");const{updateTooltip:r,resetTooltip:a,selectedRunUuid:i,closeContextMenu:s}=t,o=(0,n.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;r(t,e,n,a)}),[r,e]);return{setTooltip:o,resetTooltip:a,selectedRunUuid:i,closeContextMenu:s}},Sa={contextMenuContainer:{overflow:"hidden",top:0,left:0,width:"100%",height:"100%",position:"fixed",pointerEvents:"none"},contextMenuWrapper:e=>({zIndex:1,position:"absolute",padding:e.spacing.sm,backgroundColor:"white",border:`1px solid ${e.colors.border}`,left:-999,top:-999}),overlayElement:()=>({"&::after":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"transparent"}})};var ka={name:"1ykowef",styles:"margin-bottom:0"};const wa=e=>{let{title:t,subtitle:r,onDelete:n,onEdit:a,children:i,fullWidth:s=!1}=e;return(0,u.BX)("div",{css:Ma.chartEntry(s),"data-testid":"experiment-view-compare-runs-card",children:[(0,u.BX)("div",{css:Ma.chartEntryTitle,children:[(0,u.BX)("div",{children:[(0,u.tZ)(m.ZT$.Title,{level:4,css:ka,children:t}),r&&(0,u.tZ)("span",{css:Ma.subtitle,children:r})]}),(0,u.BX)(m.h_2.Root,{modal:!1,children:[(0,u.tZ)(m.h_2.Trigger,{asChild:!0,children:(0,u.tZ)(m.zxk,{type:"tertiary",icon:(0,u.tZ)(m.VZO,{}),"data-testid":"experiment-view-compare-runs-card-menu"})}),(0,u.BX)(m.h_2.Content,{align:"end",minWidth:100,children:[(0,u.tZ)(m.h_2.Item,{onClick:a,"data-testid":"experiment-view-compare-runs-card-edit",children:"Configure"}),(0,u.tZ)(m.h_2.Item,{onClick:n,"data-testid":"experiment-view-compare-runs-card-delete",children:"Delete"})]})]})]}),i]})},Ma={chartEntry:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t=>({height:360,maxWidth:e?"unset":800,overflow:"hidden",display:"grid",gridTemplateRows:"auto 1fr",backgroundColor:t.colors.backgroundPrimary,padding:t.spacing.md,border:`1px solid ${t.colors.border}`,borderRadius:t.general.borderRadiusBase})},chartComponentWrapper:()=>({overflow:"hidden"}),chartEntryTitle:()=>({display:"grid",gridTemplateColumns:"1fr auto",alignItems:"flex-start"}),subtitle:e=>({color:e.colors.textSecondary,fontSize:11})},Ta={t:24,b:48,r:0,l:4,pad:0},Ba=e=>{let{config:t,chartRunData:r,onDelete:a,onEdit:i}=e;const s=(0,n.useMemo)((()=>r.slice(0,t.runsCountToCompare||10).reverse()),[r,t]),{setTooltip:o,resetTooltip:l,selectedRunUuid:c}=Ra(t);return(0,u.tZ)(wa,{onEdit:i,onDelete:a,title:t.metricKey,subtitle:(0,u.BX)(u.HY,{children:["Comparing first ",s.length," runs"]}),children:(0,u.tZ)("div",{css:Ia.barChartCardWrapper,children:(0,u.tZ)(ya,{runsData:s,metricKey:t.metricKey,displayRunNames:!1,displayMetricKey:!1,useDefaultHoverBox:!1,margin:Ta,onHover:o,onUnhover:l,selectedRunUuid:c})})})},Ia={barChartCardWrapper:{overflow:"hidden"}};var La,Aa,Da,Na;function Oa(){return Oa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oa.apply(this,arguments)}function Pa(e,t){let{title:r,titleId:a,...i}=e;return n.createElement("svg",Oa({width:80,height:42,viewBox:"0 0 80 42",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},i),r?n.createElement("title",{id:a},r):null,La||(La=n.createElement("path",{d:"M1.28418 2.34094L39.4998 17.0908L76.3746 7.87216",stroke:"#CF797B",strokeLinecap:"round"})),Aa||(Aa=n.createElement("path",{d:"M1.95459 20.443L40.1702 25.1361L77.045 21.1134M1.95459 36.5338L40.1702 35.1929L77.045 25.1361",stroke:"#A88E6F",strokeLinecap:"round"})),Da||(Da=n.createElement("g",{opacity:.8},n.createElement("path",{d:"M1.28418 1V40.3341",stroke:"#338ECC",strokeLinecap:"round"}),n.createElement("path",{d:"M40.6189 2.07251V39.9763",stroke:"#338ECC",strokeLinecap:"round"}),n.createElement("path",{d:"M77.7156 2.07251V39.9763",stroke:"url(#paint0_linear_2781_406689)",strokeWidth:4,strokeLinecap:"square"}))),Na||(Na=n.createElement("defs",null,n.createElement("linearGradient",{id:"paint0_linear_2781_406689",x1:78.2156,y1:2.07251,x2:78.2156,y2:39.9763,gradientUnits:"userSpaceOnUse"},n.createElement("stop",{stopColor:"#D04F5E"}),n.createElement("stop",{offset:1,stopColor:"#4D9734"})))))}const Ua=n.forwardRef(Pa);r.p;const Ha=n.lazy((()=>Promise.all([r.e(587),r.e(168)]).then(r.bind(r,74251))));function _a(e,t,r){return e.map((e=>{const n={uuid:e.runInfo.run_uuid};function a(e,t){if(Array.isArray(e))for(const r of e)n[r]=r in t?t[r].value:null}return a(t,e.params),a(r,e.metrics),n}))}var Fa=e=>(0,u.tZ)(n.Suspense,{fallback:(0,u.tZ)(m.OdW,{}),children:(0,u.tZ)(Ha,{...e})});var Xa={name:"1neqb0a",styles:"display:flex;flex:1;justify-content:center;align-items:center"},Ka={name:"10zh1lj",styles:"display:flex;flex-direction:column;align-items:center;max-width:360px"},Wa={name:"yz1nei",styles:"margin-top:16px"},za={name:"18uqayh",styles:"margin-bottom:16px"};const $a=e=>{let{onEdit:t}=e;return(0,u.tZ)("div",{css:Xa,children:(0,u.BX)("div",{css:Ka,children:[(0,u.tZ)(Ua,{}),(0,u.tZ)(m.ZT$.Title,{css:Wa,color:"secondary",level:3,children:"Compare parameter importance"}),(0,u.tZ)(m.ZT$.Text,{css:za,color:"secondary",children:"Use the parallel coordinates chart to compare how various parameters in model affect your model metrics."}),(0,u.tZ)(m.zxk,{type:"primary",onClick:t,children:"Configure chart"})]})})},Va=e=>{let{config:t,chartRunData:r,onDelete:a,onEdit:i}=e;const[s,o]=(0,n.useMemo)((()=>{var e,n;const a=((null===(e=t.selectedParams)||void 0===e?void 0:e.length)||0)+((null===(n=t.selectedMetrics)||void 0===n?void 0:n.length)||0)>=2;return[a,a?_a(r,t.selectedParams,t.selectedMetrics):[]]}),[t,r]),{setTooltip:l,resetTooltip:c,selectedRunUuid:d,closeContextMenu:p}=Ra(t);return(0,u.tZ)(wa,{onEdit:i,onDelete:a,title:"Parallel Coordinates",subtitle:s?(0,u.BX)(u.HY,{children:["Comparing ",r.length," runs"]}):null,fullWidth:!0,children:s?o.length?(0,u.tZ)("div",{css:ja.parallelChartCardWrapper,children:(0,u.tZ)(Fa,{data:o,selectedParams:t.selectedParams,selectedMetrics:t.selectedMetrics,onHover:l,onUnhover:c,axesRotateThreshold:8,selectedRunUuid:d,closeContextMenu:p})}):null:(0,u.tZ)($a,{onEdit:i})})},ja={parallelChartCardWrapper:{display:"flex",overflow:"hidden",cursor:"pointer"}};var Ya=r(90849);const qa={displaylogo:!1,scrollZoom:!0},Ga=n.memo((e=>{let{runsData:t,xAxis:r,yAxis:a,markerSize:i=10,className:s,margin:o=va.MP,onUpdate:l,onHover:c,onUnhover:d,width:p,height:h,useDefaultHoverBox:m=!0,selectedRunUuid:g}=e;const v=(0,Ya.u)(),{layoutHeight:f,layoutWidth:y,setContainerDiv:x,containerDiv:C,isDynamicSizeSupported:b}=(0,va.Ih)(),Z=(0,n.useMemo)((()=>{const e=[],n=[],s=[],o=[];for(const i of t){var l,c;const{runInfo:{run_uuid:t,run_name:d},metrics:u,params:p,color:h}=i,m="METRIC"===r.type?u:p,g="METRIC"===a.type?u:p,f=(null===m||void 0===m||null===(l=m[r.key])||void 0===l?void 0:l.value)||void 0,y=(null===g||void 0===g||null===(c=g[a.key])||void 0===c?void 0:c.value)||void 0;f&&y&&(e.push(f),n.push(y),s.push(h||v.colors.primary),o.push([t,d||t]))}return[{x:e,y:n,customdata:o,hovertemplate:m?"<b>%{customdata[1]}:</b><br><b>%{xaxis.title.text}:</b> %{x:.2f}<br><b>%{yaxis.title.text}:</b> %{y:.2f}<br><extra></extra>":void 0,hoverinfo:m?void 0:"none",hoverlabel:m?va.Lg:void 0,type:"scatter",mode:"markers",marker:{size:i,color:s}}]}),[t,r,a,v,i,m]),[E,R]=(0,n.useState)({width:p||y,height:h||f,margin:o,xaxis:{title:r.key},yaxis:{title:a.key}});(0,n.useEffect)((()=>{R((e=>{const t={...e,width:p||y,height:h||f,margin:o};return t.xaxis&&(t.xaxis.title=r.key),t.yaxis&&(t.yaxis.title=a.key),t}))}),[y,f,o,r.key,a.key,p,h]);const{setHoveredPointIndex:S}=ga(C,g,t,ma),k=(0,n.useCallback)((e=>{var t,r,n,a;let{points:i}=e;const s=null===(t=i[0])||void 0===t||null===(r=t.customdata)||void 0===r?void 0:r[0];S(null!==(n=null===(a=i[0])||void 0===a?void 0:a.pointIndex)&&void 0!==n?n:-1),s&&(null===c||void 0===c||c(s))}),[c,S]),w=(0,n.useCallback)((()=>{null===d||void 0===d||d(),S(-1)}),[d,S]),M=da(k);return(0,u.tZ)("div",{css:[va.QW.chartWrapper,va.QW.scatterChartHighlightStyles,""],className:s,ref:x,children:(0,u.tZ)(ca.L,{data:Z,useResizeHandler:!b,css:va.QW.chart,layout:E,config:qa,onUpdate:l,onHover:M,onUnhover:w})})})),Qa=e=>{let{config:t,chartRunData:r,onDelete:a,onEdit:i}=e;const s=(0,n.useMemo)((()=>r.slice(0,t.runsCountToCompare||10).reverse()),[r,t]),{setTooltip:o,resetTooltip:l,selectedRunUuid:c}=Ra(t);return(0,u.tZ)(wa,{onEdit:i,onDelete:a,title:`${t.xaxis.key} vs. ${t.yaxis.key}`,subtitle:(0,u.BX)(u.HY,{children:["Comparing first ",s.length," runs"]}),children:(0,u.tZ)("div",{css:Ja.scatterChartCardWrapper,children:(0,u.tZ)(Ga,{runsData:s,xAxis:t.xaxis,yAxis:t.yaxis,onHover:o,onUnhover:l,useDefaultHoverBox:!1,selectedRunUuid:c})})})},Ja={scatterChartCardWrapper:{overflow:"hidden"}},ei={displaylogo:!1,scrollZoom:!0},ti=[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],ri=n.memo((e=>{let{runsData:t,xAxis:r,yAxis:a,zAxis:i,markerSize:s=10,className:o,reverseScale:l,margin:c=va.r$,colorScale:d=ti,onUpdate:p,onHover:h,onUnhover:m,width:g,height:v,useDefaultHoverBox:f=!0,selectedRunUuid:y}=e;const x=(0,Ya.u)(),{layoutHeight:C,layoutWidth:b,setContainerDiv:Z,containerDiv:E,isDynamicSizeSupported:R}=(0,va.Ih)(),S=(0,n.useMemo)((()=>{const e=[],n=[],o=[],c=[],u=[];for(const s of t){var p,h,m;const{runInfo:{run_uuid:t,run_name:l},metrics:d,params:g,color:v}=s,f="METRIC"===r.type?d:g,y="METRIC"===a.type?d:g,C="METRIC"===i.type?d:g,b=(null===f||void 0===f||null===(p=f[r.key])||void 0===p?void 0:p.value)||void 0,Z=(null===y||void 0===y||null===(h=y[a.key])||void 0===h?void 0:h.value)||void 0,E=(null===C||void 0===C||null===(m=C[i.key])||void 0===m?void 0:m.value)||void 0;b&&Z&&E&&(e.push(b),n.push(Z),o.push(E),c.push(v||x.colors.primary),u.push([t,l||t,E]))}const g=[{x:e,y:n,customdata:u,hovertemplate:f?(v=i.key,`<b>%{customdata[1]}:</b><br><b>%{xaxis.title.text}:</b> %{x:.2f}<br><b>%{yaxis.title.text}:</b> %{y:.2f}<br><b>${v}:</b> %{customdata[2]:.2f}<extra></extra>`):void 0,hoverinfo:f?void 0:"none",hoverlabel:f?va.Lg:void 0,type:"scatter",mode:"markers",marker:{size:s,color:c,line:{color:"black",width:1}}}];var v;return t.length>1&&g.unshift({x:e,y:n,z:o,type:"contour",connectgaps:!0,hoverinfo:"none",contours:{coloring:"heatmap"},colorscale:d,reversescale:l}),g}),[d,l,s,t,r.type,r.key,a.type,a.key,i.type,i.key,x.colors.primary,f]),[k,w]=(0,n.useState)({width:g||b,height:v||C,margin:c,xaxis:{title:r.key},yaxis:{ticks:"inside",title:{standoff:32,text:a.key}}});(0,n.useEffect)((()=>{w((e=>{const t={...e,width:g||b,height:v||C,margin:c};return t.xaxis&&(t.xaxis.title=r.key),t.yaxis&&(t.yaxis.title={standoff:32,text:a.key}),t}))}),[b,C,c,r.key,a.key,g,v]);const{setHoveredPointIndex:M}=ga(E,y,t,ma),T=(0,n.useCallback)((e=>{var t,r;let{points:n}=e;const a=n.find((e=>{let{curveNumber:t}=e;return 1===t}));if(M(null!==(t=null===a||void 0===a?void 0:a.pointIndex)&&void 0!==t?t:-1),!a)return;const i=null===a||void 0===a||null===(r=a.customdata)||void 0===r?void 0:r[0];i&&(null===h||void 0===h||h(i))}),[h,M]),B=(0,n.useCallback)((()=>{null===m||void 0===m||m(),M(-1)}),[m,M]),I=da(T);return(0,u.tZ)("div",{css:[va.QW.chartWrapper,va.QW.scatterChartHighlightStyles,""],className:o,ref:Z,children:(0,u.tZ)(ca.L,{data:S,useResizeHandler:!R,css:va.QW.chart,onUpdate:p,layout:k,config:ei,onHover:I,onUnhover:B})})})),ni=e=>{let{config:t,chartRunData:r,onDelete:a,onEdit:i}=e;const s=(0,n.useMemo)((()=>r.slice(0,t.runsCountToCompare||10).reverse()),[r,t]),{setTooltip:o,resetTooltip:l,selectedRunUuid:c}=Ra(t);return(0,u.tZ)(wa,{onEdit:i,onDelete:a,title:`${t.xaxis.key} vs. ${t.yaxis.key} vs. ${t.zaxis.key}`,subtitle:(0,u.BX)(u.HY,{children:["Comparing first ",s.length," runs"]}),children:(0,u.tZ)("div",{css:ai.contourChartCardWrapper,children:(0,u.tZ)(ri,{runsData:s,xAxis:t.xaxis,yAxis:t.yaxis,zAxis:t.zaxis,useDefaultHoverBox:!1,onHover:o,onUnhover:l,selectedRunUuid:c})})})},ai={contourChartCardWrapper:{overflow:"hidden"}},ii={displaylogo:!1,doubleClick:"autosize",scrollZoom:!0},si=(e,t)=>{if(!e)return[];if("time-relative"===t){const{timestamp:t}=(0,o.minBy)(e,"timestamp")||{};if(t)return e.map((e=>(e.timestamp-t)/1e3))}else if("time"===t)return e.map((e=>e.timestamp));return e.map((e=>e.step))},oi=n.memo((e=>{let{runsData:t,metricKey:r,scaleType:i="linear",xAxisKey:s="step",className:o,margin:l=va.MP,lineShape:c="spline",onUpdate:d,onHover:p,onUnhover:h,width:m,height:g,useDefaultHoverBox:v=!0,selectedRunUuid:f}=e;const y=(0,n.useMemo)((()=>t.map((e=>{var t,n;return e.metricsHistory?{uuid:e.runInfo.run_uuid,name:e.runInfo.run_name,x:si(e.metricsHistory[r],s),y:null===(t=e.metricsHistory[r])||void 0===t?void 0:t.map((e=>(0,va.To)(e.value))),hovertext:e.runInfo.run_name,text:"x",textposition:"outside",textfont:{size:11},hovertemplate:v?(n=e.runInfo.run_name,`<b>${n}</b>:<br><b>%{xaxis.title.text}:</b> %{x}<br><b>%{yaxis.title.text}:</b> %{y:.2f}<br><extra></extra>`):void 0,hoverinfo:v?void 0:"none",hoverlabel:v?va.Lg:void 0,type:"scatter",line:{shape:c},marker:{color:e.color}}:{}}))),[t,c,s,r,v]),{layoutHeight:x,layoutWidth:C,setContainerDiv:b,containerDiv:Z,isDynamicSizeSupported:E}=(0,va.Ih)(),{formatMessage:R}=(0,a.Z)(),{setHoveredPointIndex:S}=ga(Z,f,t,ha),k=(0,n.useMemo)((()=>R("time"===s?{id:"y0rS56",defaultMessage:"Time"}:"time-relative"===s?{id:"d/lwTE",defaultMessage:"Time (s)"}:{id:"vPUy4a",defaultMessage:"Step"})),[R,s]),w=(0,n.useMemo)((()=>({tickfont:{size:11},type:"log"===i?"log":"linear"})),[i]),[M,T]=(0,n.useState)({width:m||C,height:g||x,margin:l,xaxis:{title:k},yaxis:w});(0,n.useEffect)((()=>{T((e=>({...e,width:m||C,height:g||x,margin:l,yaxis:w,showlegend:!1})))}),[C,x,l,w,m,g,k]);const B=(0,n.useCallback)((e=>{var t,r,n,a,i;let{points:s,event:o}=e;S(null!==(t=null===(r=s[0])||void 0===r?void 0:r.curveNumber)&&void 0!==t?t:-1);const l=(null===(n=s[0])||void 0===n?void 0:n.data).uuid,c={value:null===(a=s[0])||void 0===a?void 0:a.x,index:null===(i=s[0])||void 0===i?void 0:i.pointIndex,label:k};l&&(null===p||void 0===p||p(l,o,c))}),[p,S,k]),I=(0,n.useCallback)((()=>{null===h||void 0===h||h(),S(-1)}),[h,S]),L=M;L.xaxis&&(L.xaxis.title=k,L.xaxis.type="time"===s?"date":void 0),L.yaxis&&(L.yaxis.title=r);const A=da(B);return(0,u.tZ)("div",{css:[va.QW.chartWrapper,li.highlightStyles,""],className:o,ref:b,children:(0,u.tZ)(ca.L,{data:y,useResizeHandler:!E,css:va.QW.chart,onUpdate:d,layout:L,config:ii,onHover:A,onUnhover:I})})})),li={highlightStyles:{".scatterlayer g.trace":{transition:"var(--trace-transition)"},".scatterlayer.is-highlight g.trace":{opacity:"var(--trace-opacity-dimmed-low) !important"},".scatterlayer g.trace.is-hover-highlight":{opacity:"var(--trace-opacity-highlighted) !important"},".scatterlayer g.trace.is-selection-highlight":{opacity:"var(--trace-opacity-highlighted) !important"},".scatterlayer g.trace.is-selection-highlight path.point":{stroke:"var(--trace-stroke-color)",strokeWidth:"var(--trace-stroke-width) !important"}}},ci=e=>{let{config:t,chartRunData:r,isMetricHistoryLoading:a,onDelete:i,onEdit:s}=e;const o=(0,n.useMemo)((()=>r.slice(0,t.runsCountToCompare||10).reverse()),[r,t]),{setTooltip:l,resetTooltip:c,selectedRunUuid:d}=Ra(t);return(0,u.tZ)(wa,{onEdit:s,onDelete:i,title:t.metricKey,subtitle:(0,u.BX)(u.HY,{children:["Comparing first ",o.length," runs"]}),children:(0,u.tZ)("div",{css:di.lineChartCardWrapper,children:a?(0,u.tZ)(m.OdW,{}):(0,u.tZ)(oi,{runsData:o,metricKey:t.metricKey,scaleType:t.scaleType,xAxisKey:t.xAxisKey,useDefaultHoverBox:!1,onHover:l,onUnhover:c,selectedRunUuid:d})})})},di={lineChartCardWrapper:{overflow:"hidden"}},ui=e=>{let{chartRunData:t,cardsConfig:r,isMetricHistoryLoading:a,onRemoveChart:i,onStartEditChart:s}=e;const[o,l]=(0,n.useMemo)((()=>Array.isArray(r)?[r.filter((e=>e.type===fn.PARALLEL)),r.filter((e=>e.type!==fn.PARALLEL))]:[[],[]]),[r]);return(0,u.BX)(u.HY,{children:[o.length?(0,u.tZ)("div",{css:pi.parallelChartsWrapper,children:o.map((e=>(0,u.tZ)(Va,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e)})))}):null,(0,u.tZ)("div",{css:pi.chartsWrapper,children:l.map((e=>e.type===fn.BAR?(0,u.tZ)(Ba,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e)}):e.type===fn.LINE?(0,u.tZ)(ci,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e),isMetricHistoryLoading:a}):e.type===fn.SCATTER?(0,u.tZ)(Qa,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e)}):e.type===fn.CONTOUR?(0,u.tZ)(ni,{config:e,chartRunData:t,onEdit:()=>s(e),onDelete:()=>i(e)}):null))})]})},pi={chartGroupWrapper:e=>({display:"flex",flexDirection:"column",gap:e.spacing.md}),parallelChartsWrapper:e=>({display:"flex",flexDirection:"column",gap:e.spacing.md,marginBottom:e.spacing.md}),chartsWrapper:e=>({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(520px, 1fr))",gap:e.spacing.md})},hi=e=>{let{title:t,children:r}=e;return(0,u.BX)("div",{css:e=>({marginBottom:2*e.spacing.md}),"data-testid":"experiment-view-compare-runs-config-field",children:[(0,u.BX)(m.ZT$.Title,{level:4,children:[t,":"]}),r]})},mi=e=>{let{value:t,onChange:r,metricKeyList:n,paramKeyList:i}=e;const{formatMessage:s}=(0,a.Z)(),o=!(null!==i&&void 0!==i&&i.length)&&!(null!==n&&void 0!==n&&n.length);return(0,u.BX)(m.PhF,{css:fi.selectFull,value:o?s({id:"3VURvw",defaultMessage:"No metrics or parameters available"}):t,disabled:o,onChange:r,dangerouslySetAntdProps:{showSearch:!0},children:[null!==n&&void 0!==n&&n.length?(0,u.tZ)(m.PhF.OptGroup,{label:s({id:"jH0+gA",defaultMessage:"Metrics"}),children:n.map((e=>(0,u.tZ)(m.PhF.Option,{value:Xe("METRIC",e),children:e},Xe("METRIC",e))))}):null,null!==i&&void 0!==i&&i.length?(0,u.tZ)(m.PhF.OptGroup,{label:s({id:"kWUhea",defaultMessage:"Params"}),children:i.map((e=>(0,u.tZ)(m.PhF.Option,{value:Xe("PARAM",e),children:e},Xe("PARAM",e))))}):null]})},gi=e=>{let{onChange:t,value:r,options:n}=e;const{formatMessage:i}=(0,a.Z)();return(0,u.tZ)(hi,{title:i({id:"AW2rVK",defaultMessage:"Max. no of runs shown"}),children:(0,u.tZ)(m.PhF,{css:fi.selectFull,value:r,onChange:t,children:n.map((e=>{const t="number"===typeof e?e:e.value,r="number"===typeof e?e:e.label;return(0,u.tZ)(m.PhF.Option,{value:t,children:r},t)}))})})},vi=[{value:5,label:(0,u.tZ)(b.Z,{id:"Mc6Dhy",defaultMessage:"5"})},{value:10,label:(0,u.tZ)(b.Z,{id:"2K8tsp",defaultMessage:"10"})},{value:20,label:(0,u.tZ)(b.Z,{id:"zwO8+l",defaultMessage:"20"})}],fi={selectFull:{width:"100%"}},yi=e=>{let{state:t,onStateChange:r,metricKeyList:a}=e;const i=(0,n.useCallback)((e=>{r((t=>({...t,metricKey:e})))}),[r]),s=(0,n.useCallback)((e=>{r((t=>({...t,runsCountToCompare:e})))}),[r]);(0,n.useEffect)((()=>{!t.metricKey&&null!==a&&void 0!==a&&a[0]&&i(a[0])}),[t.metricKey,i,a]);const o=0===a.length;return(0,u.BX)(u.HY,{children:[(0,u.tZ)(hi,{title:"Metric",children:(0,u.tZ)(m.PhF,{css:xi.selectFull,value:o?"No metrics available":t.metricKey,onChange:i,disabled:o,children:a.map((e=>(0,u.tZ)(m.PhF.Option,{value:e,"data-testid":`metric-${e}`,children:e},e)))})}),(0,u.tZ)(gi,{value:t.runsCountToCompare,onChange:s,options:vi})]})},xi={selectFull:{width:"100%"}},Ci=e=>{let{state:t,onStateChange:r,metricKeyList:a,paramKeyList:i}=e;const s=(0,n.useCallback)((e=>{r((t=>({...t,selectedParams:e})))}),[r]),o=(0,n.useCallback)((e=>{r((t=>({...t,selectedMetrics:e})))}),[r]),l=0===a.length,c=0===i.length;return(0,u.BX)(u.HY,{children:[(0,u.tZ)(hi,{title:"Params",children:(0,u.tZ)(m.PhF,{mode:c?void 0:"multiple",onChange:s,style:{width:300},value:c?"No parameters available":t.selectedParams,disabled:c,children:i.map((e=>(0,u.tZ)(m.PhF.Option,{value:e,children:e})))})}),(0,u.tZ)(hi,{title:"Metrics",children:(0,u.tZ)(m.PhF,{mode:l?void 0:"multiple",onChange:o,style:{width:300},value:l?"No metrics available":t.selectedMetrics,disabled:l,children:a.map((e=>(0,u.tZ)(m.PhF.Option,{value:e,children:e})))})})]})},bi=e=>{let{state:t,onStateChange:r,metricKeyList:a}=e;const i=(0,n.useCallback)((e=>{r((t=>({...t,metricKey:e})))}),[r]),s=(0,n.useCallback)((e=>{r((t=>({...t,xAxisKey:e})))}),[r]),o=(0,n.useCallback)((e=>r((t=>({...t,scaleType:e?"log":"linear"})))),[r]),l=(0,n.useCallback)((e=>{r((t=>({...t,runsCountToCompare:e})))}),[r]);(0,n.useEffect)((()=>{!t.metricKey&&null!==a&&void 0!==a&&a[0]&&i(a[0])}),[t.metricKey,i,a]);const c=0===a.length;return(0,u.BX)(u.HY,{children:[(0,u.tZ)(hi,{title:"Metric (Y-axis)",children:(0,u.tZ)(m.PhF,{css:Zi.selectFull,value:c?"No metrics available":t.metricKey,onChange:i,disabled:c,children:a.map((e=>(0,u.tZ)(m.PhF.Option,{value:e,"data-testid":`metric-${e}`,children:e},e)))})}),(0,u.tZ)(hi,{title:"X-axis",children:(0,u.BX)(m.Y8K.Group,{value:t.xAxisKey,onChange:e=>{let{target:{value:t}}=e;return s(t)},children:[(0,u.tZ)(m.Y8K,{value:"step",children:"Step"}),(0,u.BX)(m.Y8K,{value:"time",children:["Time (wall)",(0,u.BX)(m.ua7,{title:(0,u.tZ)(b.Z,{id:"nlXn2G",defaultMessage:"Absolute date and time"}),placement:"right",children:[" ",(0,u.tZ)(m.AMp,{css:Zi.timeStepQuestionMarkIcon})]})]}),(0,u.BX)(m.Y8K,{value:"time-relative",children:["Time (relative)",(0,u.BX)(m.ua7,{title:(0,u.tZ)(b.Z,{id:"NwNrl4",defaultMessage:"Amount of time that has passed since the first metric value was logged"}),placement:"right",children:[" ",(0,u.tZ)(m.AMp,{css:Zi.timeStepQuestionMarkIcon})]})]})]})}),(0,u.tZ)(hi,{title:"Y-axis log scale",children:(0,u.tZ)(m.rsf,{checked:"log"===t.scaleType,onChange:o,label:"Enabled"})}),(0,u.tZ)(gi,{value:t.runsCountToCompare,onChange:l,options:[5,10,20]})]})},Zi={selectFull:{width:"100%"},timeStepQuestionMarkIcon:()=>({svg:{width:12,height:12}})},Ei=(e,t,r)=>{const a=d(),[s,o]=(0,n.useState)(null),[l,c]=(0,n.useState)({}),u=(0,n.useCallback)(((e,t,r)=>{c((n=>{const a={...n};for(const i of e){a[`${i}-${t}`]=r}return a}))}),[c]),p=(0,n.useCallback)(((e,t)=>u(e,t,!0)),[u]),h=(0,n.useCallback)(((e,t)=>u(e,t,!1)),[u]),m=(0,n.useMemo)((()=>{const r=t.map((e=>e.runInfo.run_uuid));for(const t of r)for(const r of e){if(l[`${t}-${r}`])return!0}return!1}),[e,l,t]);return(0,n.useEffect)((()=>{if(e.length)for(const n of e){if(!n)continue;const e=t.map((e=>e.runInfo.run_uuid)).filter((e=>{var t;const a=Boolean(null===(t=r[e])||void 0===t?void 0:t[n]),i=l[`${e}-${n}`];return!a&&!i}));e.length&&(p(e,n),a((0,i.zL)(e,n)).then((()=>{h(e,n)})).catch((e=>{o(e)})))}}),[p,r,a,h,e,l,t]),{isLoading:m,error:s}},Ri=(0,c.$j)((e=>{let{entities:{metricsByRunUuid:t}}=e;return{metricsByRunUuid:t}}),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.metricsByRunUuid===t.entities.metricsByRunUuid})((e=>{let{previewData:t,cardConfig:r,metricsByRunUuid:a}=e;const i=(0,n.useMemo)((()=>[r.metricKey]),[r.metricKey]),{isLoading:s,error:o}=Ei(i,t,a),l=(0,n.useMemo)((()=>t.map((e=>({...e,metricsHistory:a[e.runInfo.run_uuid]})))),[t,a]),{resetTooltip:c,setTooltip:d}=Ra(r);return s?(0,u.tZ)(m.OdW,{}):o?(0,u.tZ)(u.HY,{children:"Error occured!"}):(0,u.tZ)(oi,{runsData:l,metricKey:r.metricKey,scaleType:r.scaleType,xAxisKey:r.xAxisKey,useDefaultHoverBox:!1,onHover:d,onUnhover:c})}));var Si={name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"};const ki=e=>{let{state:t,onStateChange:r,metricKeyList:i,paramKeyList:s}=e;const{formatMessage:o}=(0,a.Z)(),l=(0,n.useCallback)(((e,t)=>{const n=Ke(e,"METRIC")?"METRIC":"PARAM",a=We(e,n);r((e=>({...e,[t]:{key:a,type:n}})))}),[r]),c=(0,n.useCallback)((e=>{r((t=>({...t,runsCountToCompare:e})))}),[r]);return(0,n.useEffect)((()=>{var e,r,n;const a=null===i||void 0===i?void 0:i[0],o=null===s||void 0===s?void 0:s[0];null!==(e=t.xaxis)&&void 0!==e&&e.key||(a?l(Xe("METRIC",a),"xaxis"):o&&l(Xe("PARAM",o),"xaxis")),null!==(r=t.yaxis)&&void 0!==r&&r.key||(a?l(Xe("METRIC",a),"yaxis"):o&&l(Xe("PARAM",o),"yaxis")),null!==(n=t.zaxis)&&void 0!==n&&n.key||(a?l(Xe("METRIC",a),"zaxis"):o&&l(Xe("PARAM",o),"zaxis"))}),[t.xaxis,t.yaxis,t.zaxis,l,i,s]),(0,u.BX)(u.HY,{children:[(0,u.tZ)(hi,{title:o({id:"2Us2jl",defaultMessage:"X axis"}),children:(0,u.tZ)(mi,{value:t.xaxis.key?Xe(t.xaxis.type,t.xaxis.key):"",onChange:e=>{l(e,"xaxis")},paramKeyList:s,metricKeyList:i})}),(0,u.tZ)(hi,{title:o({id:"8YmId5",defaultMessage:"Y axis"}),children:(0,u.tZ)(mi,{value:t.yaxis.key?Xe(t.yaxis.type,t.yaxis.key):"",onChange:e=>{l(e,"yaxis")},paramKeyList:s,metricKeyList:i})}),(0,u.tZ)(hi,{title:o({id:"cB0/61",defaultMessage:"Z axis"}),children:(0,u.tZ)(mi,{value:t.zaxis.key?Xe(t.zaxis.type,t.zaxis.key):"",onChange:e=>{l(e,"zaxis")},paramKeyList:s,metricKeyList:i})}),(0,u.tZ)(gi,{value:t.runsCountToCompare,onChange:c,options:[5,10,20]})]})},wi=vi;wi.push({value:100,label:(0,u.tZ)(b.Z,{id:"Bbm59f",defaultMessage:"100"})},{value:250,label:(0,u.tZ)(b.Z,{id:"W8bOkn",defaultMessage:"250"})},{value:500,label:(0,u.tZ)(b.Z,{id:"Bnruyp",defaultMessage:"500"})});const Mi=e=>{let{state:t,onStateChange:r,metricKeyList:i,paramKeyList:s}=e;const{formatMessage:o}=(0,a.Z)(),l=(0,n.useCallback)(((e,t)=>{const n=Ke(e,"METRIC")?"METRIC":"PARAM",a=We(e,n);r((e=>({...e,[t]:{key:a,type:n}})))}),[r]),c=(0,n.useCallback)((e=>{r((t=>({...t,runsCountToCompare:e})))}),[r]);return(0,n.useEffect)((()=>{var e,r;const n=null===i||void 0===i?void 0:i[0],a=null===s||void 0===s?void 0:s[0];null!==(e=t.xaxis)&&void 0!==e&&e.key||(n?l(Xe("METRIC",n),"xaxis"):a&&l(Xe("PARAM",a),"xaxis")),null!==(r=t.yaxis)&&void 0!==r&&r.key||(n?l(Xe("METRIC",n),"yaxis"):a&&l(Xe("PARAM",a),"yaxis"))}),[t.xaxis,t.yaxis,l,i,s]),(0,u.BX)(u.HY,{children:[(0,u.tZ)(hi,{title:o({id:"vBKFgp",defaultMessage:"X axis"}),children:(0,u.tZ)(mi,{value:t.xaxis.key?Xe(t.xaxis.type,t.xaxis.key):"",onChange:e=>{l(e,"xaxis")},paramKeyList:s,metricKeyList:i})}),(0,u.tZ)(hi,{title:o({id:"DaF+KK",defaultMessage:"Y axis"}),children:(0,u.tZ)(mi,{value:t.yaxis.key?Xe(t.yaxis.type,t.yaxis.key):"",onChange:e=>{l(e,"yaxis")},paramKeyList:s,metricKeyList:i})}),(0,u.tZ)(gi,{value:t.runsCountToCompare,onChange:c,options:wi})]})},Ti=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;if("number"===typeof e)return e.toFixed(t);const r=Number(e);return isNaN(r)?(0,va.aS)(e,8):r.toFixed(t)},Bi=e=>{let{activeRun:t,cardConfig:r,isHovering:n,xAxisValues:a}=e;return r.type===fn.BAR?((e,t)=>{const{metricKey:r}=e,n=null===t||void 0===t?void 0:t.metrics[r];return n?(0,u.BX)("div",{css:Li.value,children:[(0,u.BX)("strong",{children:[n.key,":"]})," ",Ti(n.value)]}):null})(r,t):r.type===fn.SCATTER?((e,t)=>{var r,n,a,i;const{xaxis:s,yaxis:o}=e,l=s.key,c=o.key,d="METRIC"===s.type?null===(r=t.metrics[l])||void 0===r?void 0:r.value:null===(n=t.params[l])||void 0===n?void 0:n.value,p="METRIC"===o.type?null===(a=t.metrics[c])||void 0===a?void 0:a.value:null===(i=t.params[c])||void 0===i?void 0:i.value;return(0,u.BX)(u.HY,{children:[d&&(0,u.BX)("div",{css:Li.value,children:[(0,u.BX)("strong",{children:["X (",l,"):"]})," ",Ti(d)]}),p&&(0,u.BX)("div",{css:Li.value,children:[(0,u.BX)("strong",{children:["Y (",c,"):"]})," ",Ti(p)]})]})})(r,t):r.type===fn.CONTOUR?((e,t)=>{var r,n,a,i,s,o;const{xaxis:l,yaxis:c,zaxis:d}=e,p=l.key,h=c.key,m=d.key,g="METRIC"===l.type?null===(r=t.metrics[p])||void 0===r?void 0:r.value:null===(n=t.params[p])||void 0===n?void 0:n.value,v="METRIC"===c.type?null===(a=t.metrics[h])||void 0===a?void 0:a.value:null===(i=t.params[h])||void 0===i?void 0:i.value,f="METRIC"===d.type?null===(s=t.metrics[m])||void 0===s?void 0:s.value:null===(o=t.params[m])||void 0===o?void 0:o.value;return(0,u.BX)(u.HY,{children:[g&&(0,u.BX)("div",{css:Li.value,children:[(0,u.BX)("strong",{children:["X (",p,"):"]})," ",Ti(g)]}),v&&(0,u.BX)("div",{css:Li.value,children:[(0,u.BX)("strong",{children:["Y (",h,"):"]})," ",Ti(v)]}),f&&(0,u.BX)("div",{css:Li.value,children:[(0,u.BX)("strong",{children:["Z (",m,"):"]})," ",Ti(f)]})]})})(r,t):r.type===fn.LINE?((e,t,r)=>{var n,a,i;const{metricKey:s}=e,o=null!==(n=r&&(null===t||void 0===t||null===(a=t.metricsHistory)||void 0===a||null===(i=a[s])||void 0===i?void 0:i[null===r||void 0===r?void 0:r.index]))&&void 0!==n?n:null===t||void 0===t?void 0:t.metrics[s];return o?(0,u.BX)(u.HY,{children:[r&&(0,u.BX)("div",{css:Li.value,children:[(0,u.BX)("strong",{children:[r.label,":"]})," ",r.value]}),(0,u.BX)("div",{css:Li.value,children:[(0,u.BX)("strong",{children:[o.key,":"]})," ",Ti(o.value)]})]}):null})(r,t,a):r.type===fn.PARALLEL?((e,t,r)=>{const{selectedParams:n,selectedMetrics:a}=e,i=n.map((e=>{const r=null===t||void 0===t?void 0:t.params[e];return!r||(0,u.BX)("div",{children:[(0,u.BX)("strong",{children:[r.key,":"]})," ",Ti(r.value)]})})),s=a.map((e=>{const r=null===t||void 0===t?void 0:t.metrics[e];return!r||(0,u.BX)("div",{children:[(0,u.BX)("strong",{children:[r.key,":"]})," ",Ti(r.value)]})}));return r?(0,u.BX)(u.HY,{children:[i.slice(0,3),s[s.length-1],(i.length>3||s.length>1)&&(0,u.tZ)("div",{children:"..."})]}):(0,u.BX)(u.HY,{children:[i,s]})})(r,t,n):null},Ii=e=>{let{closeContextMenu:t,contextData:r,additionalAxisData:n,hoverData:a,runUuid:i,isHovering:s}=e;const{runs:o,onTogglePin:l,onHideRun:c}=r,[d]=pt(),p=null===o||void 0===o?void 0:o.find((e=>e.runInfo.run_uuid===i));return p?(0,u.BX)("div",{children:[(0,u.BX)("div",{css:Li.contentWrapper,children:[(0,u.BX)("div",{css:Li.header,children:[(0,u.tZ)("div",{css:Li.colorPill,style:{backgroundColor:p.color}}),(0,u.tZ)(ae.rU,{to:ie.Z.getRunPageRoute(d,i),target:"_blank",css:Li.runLink,onClick:t,children:p.runInfo.run_name||p.runInfo.run_uuid})]}),!s&&(0,u.tZ)(m.zxk,{size:"small",onClick:t,icon:(0,u.tZ)(m.Two,{})})]}),(0,u.tZ)(Bi,{isHovering:s,activeRun:p,cardConfig:a,xAxisValues:n}),(0,u.BX)("div",{css:Li.actionsWrapper,children:[p.pinnable&&l&&(0,u.tZ)(m.ua7,{title:p.pinned?(0,u.tZ)(b.Z,{id:"ugm2f6",defaultMessage:"Unpin run"}):(0,u.tZ)(b.Z,{id:"58xhem",defaultMessage:"Click to pin the run"}),placement:"bottom",children:(0,u.tZ)(m.zxk,{size:"small",onClick:()=>{l(i),t()},icon:p.pinned?(0,u.tZ)(m.D$V,{}):(0,u.tZ)(m.qQX,{})})}),c&&(0,u.tZ)(m.ua7,{title:(0,u.tZ)(b.Z,{id:"eE5VIF",defaultMessage:"Click to hide the run"}),placement:"bottom",children:(0,u.tZ)(m.zxk,{"data-testid":"experiment-view-compare-runs-tooltip-visibility-button",size:"small",onClick:()=>{c(i),t()},icon:(0,u.tZ)(m.bMb,{})})})]})]}):null},Li={runLink:e=>({color:e.colors.primary,"&:hover":{}}),actionsWrapper:{marginTop:8,display:"flex",gap:8,alignItems:"center"},header:{display:"flex",gap:8,alignItems:"center"},value:{maxWidth:300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},contentWrapper:{display:"flex",gap:8,alignItems:"center",marginBottom:12,justifyContent:"space-between",height:24},colorPill:{width:12,height:12,borderRadius:"100%"}};const Ai={[fn.BAR]:e=>{let{previewData:t,cardConfig:r}=e;const{resetTooltip:n,setTooltip:a}=Ra(r);return(0,u.tZ)(ya,{useDefaultHoverBox:!1,displayRunNames:!1,displayMetricKey:!1,metricKey:r.metricKey,runsData:t,margin:Ta,onHover:a,onUnhover:n})},[fn.CONTOUR]:e=>{let{previewData:t,cardConfig:r}=e;const{resetTooltip:n,setTooltip:a}=Ra(r);return(0,u.tZ)(ri,{xAxis:r.xaxis,yAxis:r.yaxis,zAxis:r.zaxis,runsData:t,onHover:a,onUnhover:n,useDefaultHoverBox:!1})},[fn.LINE]:Ri,[fn.PARALLEL]:e=>{var t,r;let{previewData:n,cardConfig:a}=e;const i=((null===(t=a.selectedParams)||void 0===t?void 0:t.length)||0)+((null===(r=a.selectedMetrics)||void 0===r?void 0:r.length)||0)>=2,{setTooltip:s,resetTooltip:o}=Ra(a),l=i?_a(n,a.selectedParams,a.selectedMetrics):[];return i?l.length?(0,u.tZ)(Fa,{selectedMetrics:a.selectedMetrics,selectedParams:a.selectedParams,data:l,axesRotateThreshold:6,onHover:s,onUnhover:o}):null:(0,u.tZ)("div",{css:Si,children:"Select at least two metrics and params first"})},[fn.SCATTER]:e=>{let{previewData:t,cardConfig:r}=e;const{resetTooltip:n,setTooltip:a}=Ra(r);return(0,u.tZ)(Ga,{xAxis:r.xaxis,yAxis:r.yaxis,runsData:t,onHover:a,onUnhover:n,useDefaultHoverBox:!1})}};var Di={name:"1uahl7",styles:"width:1280px"},Ni={name:"1d3w5wq",styles:"width:100%"};const Oi=e=>{let{onCancel:t,onSubmit:r,config:i,chartRunData:s,metricKeyList:o,paramKeyList:l}=e;const[c,d]=(0,n.useState)(i),p=Boolean(c.uuid),h=(0,n.useCallback)((e=>{if(!e)return;const t=yn.getEmptyChartCardByType(e);t&&d(t)}),[]),g=(0,n.useMemo)((()=>s.slice(0,c.runsCountToCompare).reverse()),[s,c.runsCountToCompare]),{formatMessage:v}=(0,a.Z)();return(0,u.tZ)(m.u_l,{visible:!0,onCancel:t,onOk:()=>r(c),title:v(p?{id:"kBXHTA",defaultMessage:"Edit chart"}:{id:"6y36Fr",defaultMessage:"Add new chart"}),okButtonProps:{"data-testid":"experiment-view-compare-runs-chart-modal-confirm"},cancelText:v({id:"TlVXcS",defaultMessage:"Cancel"}),okText:v(p?{id:"vPnoNk",defaultMessage:"Save changes"}:{id:"UzZf+2",defaultMessage:"Add chart"}),size:"wide",css:Di,children:(0,u.BX)("div",{css:Pi.wrapper,children:[(0,u.BX)("div",{children:[!p&&(0,u.tZ)(hi,{title:"Type",children:(0,u.BX)(m.PhF,{css:Ni,value:c.type,onChange:h,children:[(0,u.tZ)(m.PhF.Option,{value:fn.BAR,children:(0,u.BX)("div",{css:Pi.chartTypeOption,children:[(0,u.tZ)(In,{}),"Bar chart"]})}),(0,u.tZ)(m.PhF.Option,{value:fn.SCATTER,children:(0,u.BX)("div",{css:Pi.chartTypeOption,children:[(0,u.tZ)(sa,{}),"Scatter chart"]})}),(0,u.tZ)(m.PhF.Option,{value:fn.LINE,children:(0,u.BX)("div",{css:Pi.chartTypeOption,children:[(0,u.tZ)(Xn,{}),"Line chart"]})}),(0,u.tZ)(m.PhF.Option,{value:fn.PARALLEL,children:(0,u.BX)("div",{css:Pi.chartTypeOption,children:[(0,u.tZ)(qn,{}),"Parallel coordinates"]})}),(0,u.tZ)(m.PhF.Option,{value:fn.CONTOUR,children:(0,u.BX)("div",{css:Pi.chartTypeOption,children:[(0,u.tZ)(Pn,{}),"Contour chart"]})})]})}),(f=c.type,f===fn.BAR?(0,u.tZ)(yi,{metricKeyList:o,state:c,onStateChange:d}):f===fn.CONTOUR?(0,u.tZ)(ki,{metricKeyList:o,paramKeyList:l,state:c,onStateChange:d}):f===fn.LINE?(0,u.tZ)(bi,{metricKeyList:o,state:c,onStateChange:d}):f===fn.PARALLEL?(0,u.tZ)(Ci,{metricKeyList:o,paramKeyList:l,state:c,onStateChange:d}):f===fn.SCATTER?(0,u.tZ)(Mi,{metricKeyList:o,paramKeyList:l,state:c,onStateChange:d}):null)]}),(0,u.tZ)(Ea,{contextData:{runs:s},component:Ii,hoverOnly:!0,children:(0,u.tZ)("div",{css:Pi.chartWrapper,children:(e=>{if(!e)return null;const t=Ai[e];return t?(0,u.tZ)(t,{previewData:g,cardConfig:c}):null})(c.type)})})]})});var f},Pi={chartTypeOption:e=>({display:"grid",gridTemplateColumns:`${e.general.iconSize+e.spacing.xs}px 1fr`,gap:e.spacing.xs,alignItems:"center"}),wrapper:{display:"grid",gridTemplateColumns:"300px 1fr",gap:32},field:{display:"grid",gridTemplateColumns:"80px 1fr",marginBottom:16},chartWrapper:{height:400}},Ui={controlsWrapper:e=>({marginBottom:e.spacing.md,display:"flex",justifyContent:"flex-end"}),wrapper:e=>({marginLeft:-1,position:"relative",backgroundColor:e.colors.backgroundSecondary,padding:e.spacing.md,borderLeft:`1px solid ${e.colors.border}`,zIndex:1,overflowY:"auto"})},Hi=(0,c.$j)((e=>{let{entities:t}=e;const{paramsByRunUuid:r,latestMetricsByRunUuid:n,metricsByRunUuid:a}=t;return{paramsByRunUuid:r,latestMetricsByRunUuid:n,metricsByRunUuid:a}}),void 0,void 0,{areStatesEqual:(e,t)=>e.entities===t.entities})((e=>{let{comparedRuns:t,isLoading:r,searchFacetsState:a,updateSearchFacets:i,latestMetricsByRunUuid:s,metricsByRunUuid:l,paramsByRunUuid:c,metricKeyList:d,paramKeyList:p,experimentTags:h}=e;const[g,v]=(0,n.useState)(!1),[f,y]=(0,n.useState)(null),x=(0,n.useCallback)((e=>{y(yn.getEmptyChartCardByType(e))}),[]),C=(0,n.useCallback)((e=>{y(e)}),[]);(0,n.useEffect)((()=>{g||r||v(!0)}),[g,r]);const b=(0,n.useMemo)((()=>{const e=h[q.uN],t=h[q.JG];return(null===e||void 0===e?void 0:e.value)||(null===t||void 0===t?void 0:t.value)||d[0]||""}),[h,d]);(0,n.useEffect)((()=>{a.compareRunCharts||i((e=>({...e,compareRunCharts:yn.getBaseChartConfigs(b)})),{replaceHistory:!0})}),[a.compareRunCharts,b,i]);const Z=(0,n.useCallback)((e=>{i((t=>({...t,runsPinned:t.runsPinned.includes(e)?t.runsPinned.filter((t=>t!==e)):[...t.runsPinned,e]})))}),[i]),E=(0,n.useCallback)((e=>{i((t=>({...t,runsHidden:[...t.runsHidden,e]})))}),[i]),R=(0,n.useMemo)((()=>t.filter((e=>!e.hidden)).map((e=>({runInfo:e.runInfo,metrics:s[e.runUuid]||{},params:c[e.runUuid]||{},color:e.color,pinned:e.pinned,pinnable:e.pinnable,metricsHistory:{}})))),[t,s,c]),{isLoading:S,chartRunDataWithHistory:k}=((e,t,r)=>{const a=(0,n.useMemo)((()=>e.filter((e=>e.type===fn.LINE))),[e]),i=(0,n.useMemo)((()=>{if(!a.length)return[];const e=(0,o.max)(a.map((e=>e.runsCountToCompare||10)));return t.slice(0,e)}),[a,t]),s=(0,n.useMemo)((()=>Array.from(new Set(a.map((e=>e.metricKey))))),[a]),{isLoading:l}=Ei(s,i,r);return{isLoading:l,chartRunDataWithHistory:(0,n.useMemo)((()=>i.length?t.map((e=>({...e,metricsHistory:r[e.runInfo.run_uuid]||void 0}))):t),[i,r,t])}})(a.compareRunCharts||[],R,l),w=(0,n.useMemo)((()=>({runs:k,onTogglePin:Z,onHideRun:E})),[k,E,Z]);return g?(0,u.BX)("div",{css:Ui.wrapper,"data-testid":"experiment-view-compare-runs-chart-area",children:[(0,u.tZ)("div",{css:Ui.controlsWrapper,children:(0,u.tZ)(oa,{onAddChart:x})}),(0,u.tZ)(Ea,{contextData:w,component:Ii,children:(0,u.tZ)(ui,{chartRunData:k,cardsConfig:a.compareRunCharts||[],onStartEditChart:C,onRemoveChart:e=>{i((t=>{var r;return{...t,compareRunCharts:null===(r=t.compareRunCharts)||void 0===r?void 0:r.filter((t=>t.uuid!==e.uuid))}}))},isMetricHistoryLoading:S})}),f&&(0,u.tZ)(Oi,{chartRunData:k,metricKeyList:d,paramKeyList:p,config:f,onSubmit:e=>{const t=yn.serialize({...e,uuid:(0,vn.Fs)()});e.uuid?i((r=>{var n;return{...r,compareRunCharts:null===(n=r.compareRunCharts)||void 0===n?void 0:n.map((r=>r.uuid===e.uuid?t:r))}})):i((e=>({...e,compareRunCharts:e.compareRunCharts&&[...e.compareRunCharts,t]}))),y(null)},onCancel:()=>y(null)})]}):(0,u.tZ)("div",{css:Ui.wrapper,children:(0,u.tZ)(m.OdW,{})})})),_i="FETCHED_RUN_NOTIFICATION_KEY",Fi=e=>{const{formatMessage:t}=(0,a.Z)(),r=(0,n.useCallback)(((e,r)=>e===r?t({id:"KJbYrw",defaultMessage:"Loaded {childRuns} child {childRuns, plural, =1 {run} other {runs}}"},{childRuns:r}):t({id:"ziIhFQ",defaultMessage:"Loaded {allRuns} {allRuns, plural, =1 {run} other {runs}}, including {childRuns} child {childRuns, plural, =1 {run} other {runs}}"},{allRuns:e,childRuns:r})),[t]);return(0,n.useCallback)(((t,n)=>{if(Array.isArray(t)){const{allRuns:a,childRuns:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=e.filter((e=>!t.some((t=>t.run_uuid===e.info.run_uuid)))),n=r.filter((e=>{var t;const r=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.tags;return Array.isArray(r)&&r.some((e=>e.key===Te&&Boolean(e.value)))}));return{allRuns:r.length,childRuns:n.length}}(t,n);if(i<1)return;e.close(_i),e.info({message:r(a,i),duration:3,placement:"bottomRight",key:_i})}}),[e,r])},Xi=()=>{const e=new Date;return e.setMilliseconds(0),e},Ki=n.memo((e=>{const{experiments:t,runsData:r}=e,{searchFacetsState:a,updateSearchFacets:i,fetchExperimentRuns:o,isLoadingRuns:l,loadMoreRuns:c,moreRunsAvailable:d,requestError:p}=Ot(),[h,g]=(0,n.useState)([]),[v,f]=(0,n.useState)(new un);(0,n.useEffect)((()=>{o()}),[]);const{paramKeyList:y,metricKeyList:x,tagsList:C,modelVersionsByRunUuid:b,paramsList:Z,metricsList:E,runInfos:R,runUuidsMatchingFilter:S}=r,k=(0,n.useCallback)((e=>f((t=>({...t,...e})))),[]),w=(0,n.useCallback)((()=>{k({columnSelectorVisible:!0})}),[k]),{orderByKey:M,searchFilter:T,runsExpanded:B,runsPinned:I,isComparingRuns:L,runsHidden:A}=a,D=(0,n.useMemo)((()=>!M&&!T||M===q.XZ.DATE),[M,T]),[N,O]=(0,n.useState)(Xi);(0,n.useEffect)((()=>{O(Xi)}),[R]);const P=(0,n.useMemo)((()=>s.Z.getVisibleTagKeyList(C)),[C]);(0,n.useEffect)((()=>{if(l)return;const e=gn({experiments:t,paramKeyList:y,metricKeyList:x,modelVersionsByRunUuid:b,runsExpanded:B,tagKeyList:P,nestChildren:D,referenceTime:N,runData:R.map(((e,t)=>({runInfo:e,params:Z[t],metrics:E[t],tags:C[t]}))),runUuidsMatchingFilter:S,runsPinned:I,runsHidden:A});g(e)}),[l,t,x,E,b,y,Z,R,B,C,P,D,N,I,A,S,p]);const[U,H]=(0,m.lmA)(),_=Fi(U),F=(0,n.useCallback)((()=>{d&&!l&&c().then((e=>{_(e,R)}))}),[d,l,c,R,_]);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(Xr,{viewState:v,updateViewState:k,runsData:r,searchFacetsState:a,updateSearchFacets:i,requestError:p}),(0,u.BX)("div",{css:Wi.createRunsTableWrapper(L),children:[(0,u.tZ)(ln,{experiments:t,runsData:r,searchFacetsState:a,viewState:v,isLoading:l,updateSearchFacets:i,updateViewState:k,onAddColumnClicked:w,rowsData:h,loadMoreRunsFunc:F,moreRunsAvailable:d}),L&&(0,u.tZ)(Hi,{isLoading:l,comparedRuns:h,metricKeyList:r.metricKeyList,paramKeyList:r.paramKeyList,experimentTags:r.experimentTags,searchFacetsState:a,updateSearchFacets:i}),H]})]})})),Wi={createRunsTableWrapper:e=>({minHeight:225,height:"100%",display:"grid",position:"relative",gridTemplateColumns:e?"310px 1fr":"1fr"}),loadingFooter:()=>({justifyContent:"center",alignItems:"center",display:"flex",height:"72px"})},zi={searchRunsApi:i.ht,loadMoreRunsApi:i.mx,searchRunsPayload:i.Yl,searchModelVersionsApi:dn.nI},$i=(0,c.$j)(((e,t)=>({runsData:Y(e,t)})),void 0,void 0,{areStatesEqual:(e,t)=>e.entities.experimentTagsByExperimentId===t.entities.experimentTagsByExperimentId&&e.entities.latestMetricsByRunUuid===t.entities.latestMetricsByRunUuid&&e.entities.modelVersionsByRunUuid===t.entities.modelVersionsByRunUuid&&e.entities.paramsByRunUuid===t.entities.paramsByRunUuid&&e.entities.runInfosByUuid===t.entities.runInfosByUuid&&e.entities.runUuidsMatchingFilter===t.entities.runUuidsMatchingFilter&&e.entities.tagsByRunUuid===t.entities.tagsByRunUuid})(Ki),Vi=e=>{const{searchFacetsState:t}=Ot();return(0,u.tZ)($i,{...e,modelVersionFilter:t.modelVersionFilter,lifecycleFilter:t.lifecycleFilter})},ji=e=>(0,u.tZ)(Nt,{actions:zi,children:(0,u.tZ)(Vi,{...e})}),Yi=()=>{const e=pt(),t=(r=e,(0,c.v9)((e=>r.map((t=>e.entities.experimentsById[t])).filter(Boolean)),((e,t)=>(0,o.isEqual)(e,t))));var r;const[a]=t,{fetchExperiments:i,isLoadingExperiment:s,requestError:l}=T();(0,n.useEffect)((()=>{i(e)}),[i,e]);const d=e.length>1;return l&&l.getErrorCode()===g.SM.PERMISSION_DENIED?(0,u.tZ)(C,{errorMessage:l.getMessageField()}):l&&l.getErrorCode()===g.SM.RESOURCE_DOES_NOT_EXIST?(0,u.tZ)(v.Z,{}):s||!a?(0,u.tZ)(m.OdW,{active:!0}):(0,u.BX)("div",{css:qi.experimentViewWrapper,children:[d?(0,u.tZ)(z,{experiments:t}):(0,u.BX)(u.HY,{children:[(0,u.tZ)(K,{experiment:a}),(0,u.tZ)(E,{experiment:a}),(0,u.tZ)(B,{experiment:a})]}),(0,u.tZ)(ji,{experiments:t})]})},qi={experimentViewWrapper:{height:"100%",display:"flex",flexDirection:"column"}};const Gi={setExperimentTagApi:i.Yp,getExperimentApi:i.eu,setCompareExperiments:i.MY},Qi=()=>{const{formatMessage:e}=(0,a.Z)();return(0,n.useEffect)((()=>{const t=e({id:"5GCYzy",defaultMessage:"Experiment Runs - Databricks"});s.Z.updatePageTitle(t)})),(0,u.tZ)(h,{actions:Gi,children:(0,u.tZ)(Yi,{})})};var Ji=Qi},6233:function(e,t,r){r.d(t,{Ih:function(){return i},Lg:function(){return c},MP:function(){return o},QW:function(){return s},To:function(){return d},aS:function(){return u},r$:function(){return l}});var n=r(13320),a=r(32);const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;const[t,r]=(0,a.useState)(void 0),[i,s]=(0,a.useState)(void 0),o=Boolean(window.ResizeObserver),l=(0,a.useCallback)(((e,t)=>{r(e),s(t)}),[]),c=(0,a.useMemo)((()=>(0,n.throttle)(l,e,{leading:!0})),[l,e]),[d,u]=(0,a.useState)(null);return(0,a.useEffect)((()=>{let e=!1;if(!d||!window.ResizeObserver)return;const t=new ResizeObserver((t=>{let[r]=t;e||c(Math.round(r.contentRect.width),Math.round(r.contentRect.height))}));return t.observe(d),()=>{e=!0,t.disconnect()}}),[d,c]),{containerDiv:d,setContainerDiv:u,layoutWidth:t,layoutHeight:i,isDynamicSizeSupported:o}},s={scatterChartHighlightStyles:{".trace.scatter path.point":{transition:"var(--trace-transition)"},".trace.scatter.is-highlight path.point":{opacity:"var(--trace-opacity-dimmed-low) !important"},".trace.scatter path.point.is-hover-highlight":{opacity:"var(--trace-opacity-highlighted) !important"},".trace.scatter path.point.is-selection-highlight":{opacity:"var(--trace-opacity-highlighted) !important",stroke:"var(--trace-stroke-color)",strokeWidth:"var(--trace-stroke-width) !important"}},chartWrapper:()=>({width:"100%",height:"100%",overflow:"hidden",position:"relative",fontSize:0,lineHeight:0,".js-plotly-plot .plotly .cursor-ew-resize, .js-plotly-plot .plotly .cursor-crosshair":{cursor:"pointer"},".js-plotly-plot g.infolayer > g.g-ytitle > text":{stroke:"white",strokeWidth:16,paintOrder:"stroke"},"--trace-transition":"opacity .16s","--trace-opacity-highlighted":"1","--trace-opacity-dimmed-low":"0.45","--trace-opacity-dimmed-high":"0.55","--trace-stroke-color":"black","--trace-stroke-width":"1"}),chart:{width:"100%",height:"100%"}},o={t:0,b:48,r:0,l:48,pad:0},l={t:0,b:48,r:0,l:80,pad:0},c={bgcolor:"white",bordercolor:"#ccc",font:{color:"black"}},d=e=>{const t="string"===typeof e?parseFloat(e):e;return t?Number.isFinite(t)&&!Number.isNaN(t)?Math.abs(t)===Number.MAX_VALUE?Number.POSITIVE_INFINITY*Math.sign(t):e:void 0:t},u=(e,t)=>{if(e.length<=t)return e;const r=t-"...".length,n=Math.ceil(r/2),a=Math.floor(r/2);return e.substr(0,n)+"..."+e.substr(e.length-a)}}}]);
//# sourceMappingURL=815.640fee82.chunk.js.map